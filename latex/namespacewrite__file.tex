\hypertarget{namespacewrite__file}{}\doxysection{write\+\_\+file Module Reference}
\label{namespacewrite__file}\index{write\_file@{write\_file}}


Contains the subroutines associated with writing the Net\+C\+DF files containing the calculated results and generating the coordinate text files.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacewrite__file_af21e1f0e20bc5d7ef050ca230e15025d}{atom1\+\_\+netcdf}} (filename, dof, wave1d, wave2d, wave3d)
\begin{DoxyCompactList}\small\item\em atom1\+\_\+netcdf subroutine writes the results from the 1 atom result to Net\+C\+DF file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__file_aa2915fe469549076045e50fec183f477}{energies\+\_\+netcdf}} (filename, energies, bondlen)
\begin{DoxyCompactList}\small\item\em energies\+\_\+netcdf subroutine returns a Net\+C\+DF file containing the energies of the system evlauated at particular bond lengths (the distance between the two atoms). \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__file_ab44062ede3c3b7a1d548b127bf71dfcd}{atom2\+\_\+netcdf}} (filename, dof, wave, ele)
\begin{DoxyCompactList}\small\item\em atom2\+\_\+netcdf subroutine writes the results from the 2 atom system to a Net\+C\+DF file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__file_a36860f626a8c46139a212edaf4d23a85}{xyz\+\_\+coords3d}} (start, endv)
\begin{DoxyCompactList}\small\item\em xyz\+\_\+coords3d subroutine returns a 3 column text file named xyz3d.\+txt which contains the coordinates (x,y,z) in the order they where used for a given calculation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacewrite__file_a414424a594a2b90fdc3b836c2ea4430e}{xyz\+\_\+coords2d}} (start, endv)
\item 
subroutine \mbox{\hyperlink{namespacewrite__file_a9e3b89277ccb10c11436a0847ec74c94}{xyz\+\_\+coords1d}} (start, endv)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Contains the subroutines associated with writing the Net\+C\+DF files containing the calculated results and generating the coordinate text files. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacewrite__file_af21e1f0e20bc5d7ef050ca230e15025d}\label{namespacewrite__file_af21e1f0e20bc5d7ef050ca230e15025d}} 
\index{write\_file@{write\_file}!atom1\_netcdf@{atom1\_netcdf}}
\index{atom1\_netcdf@{atom1\_netcdf}!write\_file@{write\_file}}
\doxysubsubsection{\texorpdfstring{atom1\_netcdf()}{atom1\_netcdf()}}
{\footnotesize\ttfamily subroutine write\+\_\+file\+::atom1\+\_\+netcdf (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(dp), dimension(\+:), intent(in)}]{dof,  }\item[{real(dp), dimension(\+:), intent(in)}]{wave1d,  }\item[{real(dp), dimension(\+:), intent(in)}]{wave2d,  }\item[{real(dp), dimension(\+:), intent(in)}]{wave3d }\end{DoxyParamCaption})}



atom1\+\_\+netcdf subroutine writes the results from the 1 atom result to Net\+C\+DF file. 

It outputs the optimal degrees of freedom and the wavefunction evaluated as a lineout, in the x-\/y plane and on a full 3D grid. 
\begin{DoxyParams}{Parameters}
{\em filename} & is the name of the resulting file defined in the main driver script, \mbox{\hyperlink{latin__driver_8f90}{latin\+\_\+driver.\+f90}}. \\
\hline
{\em dof} & is a 1D array containing the optimal degrees of freedom values found for the system. It outputs 2 numbers. \\
\hline
{\em wave1d} & is the wavefunction evaluated at equally spaced points along the x-\/axis. The y and z coordinate are set to zero when calculating the wavefunction. \\
\hline
{\em wave2d} & is the wavefunction evaluated along a equally spaced grid in the x-\/y plane. The z coordinate is set to zero when calculating the wavefunction. \\
\hline
{\em wave3d} & is the wavefunction evaluated fully in 3 dimensions in an equally spaced 3D grid. \\
\hline
\end{DoxyParams}


Definition at line 20 of file netcdf\+\_\+file.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{20   }
\DoxyCodeLine{21   \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: dp=kind(1.0d0)}
\DoxyCodeLine{22   \textcolor{comment}{! Declaring the input variables}}
\DoxyCodeLine{23   \textcolor{keywordtype}{CHARACTER(LEN=*)}, \textcolor{keywordtype}{INTENT(IN)} :: filename}
\DoxyCodeLine{24 \textcolor{keywordtype}{  REAL}(dp), \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: dof  }
\DoxyCodeLine{25 \textcolor{keywordtype}{  REAL}(dp), \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: wave1d, wave2d, wave3d}
\DoxyCodeLine{26   }
\DoxyCodeLine{27   \textcolor{comment}{! Dimension names for the arrays}}
\DoxyCodeLine{28   \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_dof = (/\textcolor{stringliteral}{"DOF"}/)}
\DoxyCodeLine{29   \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_wave1d = (/\textcolor{stringliteral}{"1D\_Wavefunction"}/)}
\DoxyCodeLine{30   \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_wave2d = (/\textcolor{stringliteral}{"2D\_Wavefunction"}/)}
\DoxyCodeLine{31   \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_wave3d = (/\textcolor{stringliteral}{"3D\_Wavefunction"}/)}
\DoxyCodeLine{32 }
\DoxyCodeLine{33   \textcolor{comment}{! File ID's}}
\DoxyCodeLine{34   \textcolor{keywordtype}{INTEGER} :: ierr, file\_id}
\DoxyCodeLine{35   \textcolor{comment}{! Variable ID's}}
\DoxyCodeLine{36   \textcolor{keywordtype}{INTEGER} :: var\_dof,  var\_wave1d, var\_wave2d, var\_wave3d }
\DoxyCodeLine{37   \textcolor{comment}{! Dimension ID's for the arrays}}
\DoxyCodeLine{38   \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(1)} :: did\_dof, did\_wave1d, did\_wave2d, did\_wave3d}
\DoxyCodeLine{39   \textcolor{comment}{! Implicit types for the sizes for the arrays}}
\DoxyCodeLine{40   \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(1)} :: size\_dof, size\_wave1d, size\_wave2d, size\_wave3d}
\DoxyCodeLine{41 }
\DoxyCodeLine{42   }
\DoxyCodeLine{43   \textcolor{comment}{! Create the file}}
\DoxyCodeLine{44   ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{45   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{46     print *,\textcolor{stringliteral}{"Create file error: "}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{47     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{48 \textcolor{keywordflow}{  END IF} }
\DoxyCodeLine{49   }
\DoxyCodeLine{50   }
\DoxyCodeLine{51   \textcolor{comment}{! Variable sizes}}
\DoxyCodeLine{52   size\_dof = shape(dof)}
\DoxyCodeLine{53   size\_wave1d = shape(wave1d)}
\DoxyCodeLine{54   size\_wave2d = shape(wave2d)}
\DoxyCodeLine{55   size\_wave3d = shape(wave3d)}
\DoxyCodeLine{56   }
\DoxyCodeLine{57   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{58     print *,\textcolor{stringliteral}{'Size error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{59     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{60 \textcolor{keywordflow}{  END IF} }
\DoxyCodeLine{61   }
\DoxyCodeLine{62   }
\DoxyCodeLine{63   \textcolor{comment}{! Inputting the data}}
\DoxyCodeLine{64   \textcolor{comment}{! DOF}}
\DoxyCodeLine{65   ierr = nf90\_def\_dim(file\_id, dim\_dof(1), size\_dof(1), did\_dof(1))}
\DoxyCodeLine{66   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{67     print *,\textcolor{stringliteral}{'DOF data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{68     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{69 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{70   ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"DOF"}, nf90\_double, did\_dof, var\_dof)}
\DoxyCodeLine{71   }
\DoxyCodeLine{72 }
\DoxyCodeLine{73   \textcolor{comment}{! Wavefunction results}}
\DoxyCodeLine{74   \textcolor{comment}{! 1D}}
\DoxyCodeLine{75   ierr = nf90\_def\_dim(file\_id, dim\_wave1d(1), size\_wave1d(1), did\_wave1d(1))}
\DoxyCodeLine{76   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{77     print *,\textcolor{stringliteral}{'1D Wavefunction data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{78     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{79 \textcolor{keywordflow}{  END IF} }
\DoxyCodeLine{80   ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"1D\_Wavefunction"}, nf90\_double, did\_wave1d, var\_wave1d)}
\DoxyCodeLine{81   }
\DoxyCodeLine{82   \textcolor{comment}{! 2D}}
\DoxyCodeLine{83   ierr = nf90\_def\_dim(file\_id, dim\_wave2d(1), size\_wave2d(1), did\_wave2d(1))}
\DoxyCodeLine{84   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{85     print *,\textcolor{stringliteral}{'2D Wavefunction data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{86     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{87 \textcolor{keywordflow}{  END IF} }
\DoxyCodeLine{88   ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"2D\_Wavefunction"}, nf90\_double, did\_wave2d, var\_wave2d)}
\DoxyCodeLine{89   }
\DoxyCodeLine{90   \textcolor{comment}{! 3D}}
\DoxyCodeLine{91   ierr = nf90\_def\_dim(file\_id, dim\_wave3d(1), size\_wave3d(1), did\_wave3d(1))}
\DoxyCodeLine{92   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{93     print *,\textcolor{stringliteral}{'3D Wavefunction data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{94     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{95 \textcolor{keywordflow}{  END IF} }
\DoxyCodeLine{96   ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"3D\_Wavefunction"}, nf90\_double, did\_wave3d, var\_wave3d)}
\DoxyCodeLine{97   }
\DoxyCodeLine{98   }
\DoxyCodeLine{99   \textcolor{comment}{! Metadata}}
\DoxyCodeLine{100   ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{101   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{102     print *, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{103     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{104 \textcolor{keywordflow}{  END IF}  }
\DoxyCodeLine{105   }
\DoxyCodeLine{106   }
\DoxyCodeLine{107   \textcolor{comment}{! Writing the data to file}}
\DoxyCodeLine{108   \textcolor{comment}{! DOF}}
\DoxyCodeLine{109   ierr = nf90\_put\_var(file\_id, var\_dof, dof)}
\DoxyCodeLine{110   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{111     print *,\textcolor{stringliteral}{'Writing DOF to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{112     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{113 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{114   }
\DoxyCodeLine{115   \textcolor{comment}{! 1D Wavefunction}}
\DoxyCodeLine{116   ierr = nf90\_put\_var(file\_id, var\_wave1d, wave1d)}
\DoxyCodeLine{117   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{118     print *,\textcolor{stringliteral}{'Writing Wavefunction to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{119     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{120 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{121   }
\DoxyCodeLine{122   \textcolor{comment}{! 2D Wavefunction}}
\DoxyCodeLine{123   ierr = nf90\_put\_var(file\_id, var\_wave2d, wave2d)}
\DoxyCodeLine{124   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{125     print *,\textcolor{stringliteral}{'Writing Wavefunction to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{126     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{127 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{128   }
\DoxyCodeLine{129   \textcolor{comment}{! 3D Wavefunction}}
\DoxyCodeLine{130   ierr = nf90\_put\_var(file\_id, var\_wave3d, wave3d)}
\DoxyCodeLine{131   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{132     print *,\textcolor{stringliteral}{'Writing Wavefunction to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{133     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{134 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{135   }
\DoxyCodeLine{136  }
\DoxyCodeLine{137   \textcolor{comment}{! Closing the file}}
\DoxyCodeLine{138   ierr = nf90\_close(file\_id)}
\DoxyCodeLine{139   \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{140     print *,\textcolor{stringliteral}{"File close error: "}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{141     \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{142 \textcolor{keywordflow}{  END IF}}
\DoxyCodeLine{143   }
\DoxyCodeLine{144   }
\DoxyCodeLine{145   \textcolor{comment}{!Finishing statement if writing file is successful.}}
\DoxyCodeLine{146   print *, \textcolor{stringliteral}{"Success in writing the NETCDF file: "}, filename}
\DoxyCodeLine{147   }

\end{DoxyCode}
\mbox{\Hypertarget{namespacewrite__file_ab44062ede3c3b7a1d548b127bf71dfcd}\label{namespacewrite__file_ab44062ede3c3b7a1d548b127bf71dfcd}} 
\index{write\_file@{write\_file}!atom2\_netcdf@{atom2\_netcdf}}
\index{atom2\_netcdf@{atom2\_netcdf}!write\_file@{write\_file}}
\doxysubsubsection{\texorpdfstring{atom2\_netcdf()}{atom2\_netcdf()}}
{\footnotesize\ttfamily subroutine write\+\_\+file\+::atom2\+\_\+netcdf (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(dp), dimension(\+:), intent(in)}]{dof,  }\item[{real(dp), dimension(\+:), intent(in)}]{wave,  }\item[{real(dp), dimension(\+:), intent(in)}]{ele }\end{DoxyParamCaption})}



atom2\+\_\+netcdf subroutine writes the results from the 2 atom system to a Net\+C\+DF file. 

It outputs the optimal degrees of freedom and the wavefunction evaluated on a full 3D grid. It also outputs the electron density on a full 3D grid. 
\begin{DoxyParams}{Parameters}
{\em filename} & is the name of the resulting file defined in the main driver script, \mbox{\hyperlink{latin__driver_8f90}{latin\+\_\+driver.\+f90}}. \\
\hline
{\em dof} & is a 1D array containing the optimal degrees of freedom for the 2 atom system. It returns 3 numbers. \\
\hline
{\em wave} & is a 1D array containing the calculated wavefunction for the 2 atom system evaluated on a full 3D grid. \\
\hline
{\em ele} & is a 1D array containing the electron probability density for the 2 atom system evaluated on a full 3D grid. \\
\hline
\end{DoxyParams}


Definition at line 252 of file netcdf\+\_\+file.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{252     }
\DoxyCodeLine{253     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: dp=kind(1.0d0)}
\DoxyCodeLine{254     \textcolor{comment}{! Inputting variables}}
\DoxyCodeLine{255     \textcolor{keywordtype}{CHARACTER(LEN=*)}, \textcolor{keywordtype}{INTENT(IN)} :: filename}
\DoxyCodeLine{256 \textcolor{keywordtype}{    REAL}(dp), \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: wave, ele, dof}
\DoxyCodeLine{257     }
\DoxyCodeLine{258     \textcolor{comment}{! Dimension names}}
\DoxyCodeLine{259     \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_wave = (/\textcolor{stringliteral}{"Fixed\_Wavefunction"}/)}
\DoxyCodeLine{260     \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_ele = (/\textcolor{stringliteral}{"Electron\_Density"}/)}
\DoxyCodeLine{261     \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_dof = (/\textcolor{stringliteral}{"DOF"}/)}
\DoxyCodeLine{262     }
\DoxyCodeLine{263     \textcolor{comment}{! File ID}}
\DoxyCodeLine{264     \textcolor{keywordtype}{INTEGER} :: ierr, file\_id}
\DoxyCodeLine{265     \textcolor{comment}{! Variable ID's}}
\DoxyCodeLine{266     \textcolor{keywordtype}{INTEGER} :: var\_ele, var\_wave, var\_dof}
\DoxyCodeLine{267     \textcolor{comment}{! Dimension ID for the arrays}}
\DoxyCodeLine{268     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(1)} :: did\_dof, did\_ele, did\_wave}
\DoxyCodeLine{269     \textcolor{comment}{! Implicit types for the sizes for the arrays}}
\DoxyCodeLine{270     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(1)} :: size\_dof, size\_ele, size\_wave}
\DoxyCodeLine{271   }
\DoxyCodeLine{272     }
\DoxyCodeLine{273     \textcolor{comment}{! Create the file}}
\DoxyCodeLine{274     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{275     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{276       print *,\textcolor{stringliteral}{"Create file error: "}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{277       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{278 \textcolor{keywordflow}{    END IF} }
\DoxyCodeLine{279     }
\DoxyCodeLine{280     \textcolor{comment}{! Variable sizes}}
\DoxyCodeLine{281     size\_dof = shape(dof)}
\DoxyCodeLine{282     size\_wave = shape(wave)}
\DoxyCodeLine{283     size\_ele = shape(ele)}
\DoxyCodeLine{284     }
\DoxyCodeLine{285     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{286       print *,\textcolor{stringliteral}{'Size error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{287       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{288 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{289     }
\DoxyCodeLine{290     \textcolor{comment}{! Inputting the data}}
\DoxyCodeLine{291     \textcolor{comment}{! DOF}}
\DoxyCodeLine{292     ierr = nf90\_def\_dim(file\_id, dim\_dof(1), size\_dof(1), did\_dof(1))}
\DoxyCodeLine{293     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{294       print *,\textcolor{stringliteral}{'DOF data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{295       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{296 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{297     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"DOF"}, nf90\_double, did\_dof, var\_dof)}
\DoxyCodeLine{298     }
\DoxyCodeLine{299     \textcolor{comment}{! Electron density}}
\DoxyCodeLine{300     ierr = nf90\_def\_dim(file\_id, dim\_ele(1), size\_ele(1), did\_ele(1))}
\DoxyCodeLine{301     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{302       print *,\textcolor{stringliteral}{'Electron density data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{303       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{304 \textcolor{keywordflow}{    END IF} }
\DoxyCodeLine{305     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"Electron\_Density"}, nf90\_double, did\_ele, var\_ele)}
\DoxyCodeLine{306   }
\DoxyCodeLine{307     \textcolor{comment}{! Wavefunction}}
\DoxyCodeLine{308     ierr = nf90\_def\_dim(file\_id, dim\_wave(1), size\_wave(1), did\_wave(1))}
\DoxyCodeLine{309     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{310       print *,\textcolor{stringliteral}{'Wavefunction data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{311       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{312 \textcolor{keywordflow}{    END IF} }
\DoxyCodeLine{313     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"Fixed\_Wavefunction"}, nf90\_double, did\_wave, var\_wave)}
\DoxyCodeLine{314     }
\DoxyCodeLine{315      }
\DoxyCodeLine{316     \textcolor{comment}{! Metadata}}
\DoxyCodeLine{317     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{318     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{319       print *, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{320       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{321 \textcolor{keywordflow}{    END IF} }
\DoxyCodeLine{322     }
\DoxyCodeLine{323     \textcolor{comment}{! Writing data to file}}
\DoxyCodeLine{324     \textcolor{comment}{! DOF}}
\DoxyCodeLine{325     ierr = nf90\_put\_var(file\_id, var\_dof, dof)}
\DoxyCodeLine{326     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{327       print *,\textcolor{stringliteral}{'Writing DOF to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{328       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{329 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{330     }
\DoxyCodeLine{331     \textcolor{comment}{! Electron density}}
\DoxyCodeLine{332     ierr = nf90\_put\_var(file\_id, var\_ele, ele)}
\DoxyCodeLine{333     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{334       print *,\textcolor{stringliteral}{'Writing Electron density to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{335       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{336 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{337     }
\DoxyCodeLine{338     \textcolor{comment}{! Wavefunction}}
\DoxyCodeLine{339     ierr = nf90\_put\_var(file\_id, var\_wave, wave)}
\DoxyCodeLine{340     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{341       print *,\textcolor{stringliteral}{'Writing Wavefunction to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{342       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{343 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{344     }
\DoxyCodeLine{345     \textcolor{comment}{! Closing the file}}
\DoxyCodeLine{346     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{347     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{348       print *,\textcolor{stringliteral}{"File close error: "}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{349       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{350 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{351     }
\DoxyCodeLine{352     \textcolor{comment}{!Finishing statement if writing file is successful.}}
\DoxyCodeLine{353     print *, \textcolor{stringliteral}{"Success in writing the NETCDF file: "}, filename}
\DoxyCodeLine{354     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacewrite__file_aa2915fe469549076045e50fec183f477}\label{namespacewrite__file_aa2915fe469549076045e50fec183f477}} 
\index{write\_file@{write\_file}!energies\_netcdf@{energies\_netcdf}}
\index{energies\_netcdf@{energies\_netcdf}!write\_file@{write\_file}}
\doxysubsubsection{\texorpdfstring{energies\_netcdf()}{energies\_netcdf()}}
{\footnotesize\ttfamily subroutine write\+\_\+file\+::energies\+\_\+netcdf (\begin{DoxyParamCaption}\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{real(dp), dimension(\+:), intent(in)}]{energies,  }\item[{real(dp), dimension(\+:), intent(in)}]{bondlen }\end{DoxyParamCaption})}



energies\+\_\+netcdf subroutine returns a Net\+C\+DF file containing the energies of the system evlauated at particular bond lengths (the distance between the two atoms). 

This applies to the two atom system only. 
\begin{DoxyParams}{Parameters}
{\em filename} & is the name of the resulting file defined in the main driver script, \mbox{\hyperlink{latin__driver_8f90}{latin\+\_\+driver.\+f90}}. \\
\hline
{\em energies} & is a 1D array containing the energy of the system evaluated at particular bond lengths. \\
\hline
{\em bondlen} & is a 1D array containing the bond length between the two atoms. \\
\hline
\end{DoxyParams}


Definition at line 159 of file netcdf\+\_\+file.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{159   }
\DoxyCodeLine{160     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: dp=kind(1.0d0)}
\DoxyCodeLine{161     \textcolor{comment}{! Inputting variables}}
\DoxyCodeLine{162     \textcolor{keywordtype}{CHARACTER(LEN=*)}, \textcolor{keywordtype}{INTENT(IN)} :: filename}
\DoxyCodeLine{163 \textcolor{keywordtype}{    REAL}(dp), \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{INTENT(IN)} :: energies, bondlen}
\DoxyCodeLine{164     }
\DoxyCodeLine{165     \textcolor{comment}{! Dimension names}}
\DoxyCodeLine{166     \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_e = (/\textcolor{stringliteral}{"Energies"}/)}
\DoxyCodeLine{167     \textcolor{keywordtype}{CHARACTER(LEN=100)}, \textcolor{keywordtype}{DIMENSION(1)} :: dim\_b = (/\textcolor{stringliteral}{"Bond\_Lengths"}/)}
\DoxyCodeLine{168     }
\DoxyCodeLine{169     \textcolor{comment}{! File ID}}
\DoxyCodeLine{170     \textcolor{keywordtype}{INTEGER} :: ierr, file\_id}
\DoxyCodeLine{171     \textcolor{comment}{! Variable ID's}}
\DoxyCodeLine{172     \textcolor{keywordtype}{INTEGER} :: var\_e, var\_b}
\DoxyCodeLine{173     \textcolor{comment}{! Dimension ID's for the arrays}}
\DoxyCodeLine{174     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(1)} :: did\_e, did\_b}
\DoxyCodeLine{175     \textcolor{comment}{! Implicit types for the array sizes}}
\DoxyCodeLine{176     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(1)} :: size\_e, size\_b}
\DoxyCodeLine{177     }
\DoxyCodeLine{178     \textcolor{comment}{! Create the file}}
\DoxyCodeLine{179     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{180     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{181       print *,\textcolor{stringliteral}{"Create file error: "}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{182       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{183 \textcolor{keywordflow}{    END IF}     }
\DoxyCodeLine{184     }
\DoxyCodeLine{185     \textcolor{comment}{! Variable sizes}}
\DoxyCodeLine{186     size\_e = shape(energies)}
\DoxyCodeLine{187     size\_b = shape(bondlen)}
\DoxyCodeLine{188     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{189       print *,\textcolor{stringliteral}{'Size error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{190       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{191 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{192     }
\DoxyCodeLine{193     \textcolor{comment}{! Inputting the data}}
\DoxyCodeLine{194     \textcolor{comment}{! Energies}}
\DoxyCodeLine{195     ierr = nf90\_def\_dim(file\_id, dim\_e(1), size\_e(1), did\_e(1))}
\DoxyCodeLine{196     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{197       print *,\textcolor{stringliteral}{'Energy data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{198       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{199 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{200     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"Energies"}, nf90\_double, did\_e, var\_e)}
\DoxyCodeLine{201     }
\DoxyCodeLine{202     \textcolor{comment}{! Bond length}}
\DoxyCodeLine{203     ierr = nf90\_def\_dim(file\_id, dim\_b(1), size\_b(1), did\_b(1))}
\DoxyCodeLine{204     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{205       print *,\textcolor{stringliteral}{'Bond length data error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{206       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{207 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{208     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"Bond\_length"}, nf90\_double, did\_b, var\_b)}
\DoxyCodeLine{209     }
\DoxyCodeLine{210       \textcolor{comment}{! Metadata}}
\DoxyCodeLine{211     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{212     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{213       print *, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{214       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{215 \textcolor{keywordflow}{    END IF} }
\DoxyCodeLine{216     }
\DoxyCodeLine{217     \textcolor{comment}{! Writing data to file }}
\DoxyCodeLine{218     \textcolor{comment}{! Energy}}
\DoxyCodeLine{219     ierr = nf90\_put\_var(file\_id, var\_e, energies)}
\DoxyCodeLine{220     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{221       print *,\textcolor{stringliteral}{'Writing Energy to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{222       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{223 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{224   }
\DoxyCodeLine{225     ierr = nf90\_put\_var(file\_id, var\_b, bondlen)}
\DoxyCodeLine{226     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{227       print *,\textcolor{stringliteral}{'Writing Bond length to file error: '}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{228       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{229 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{230     }
\DoxyCodeLine{231     \textcolor{comment}{! Closing the file}}
\DoxyCodeLine{232     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{233     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{234       print *,\textcolor{stringliteral}{"File close error: "}, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{235       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{236 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{237     }
\DoxyCodeLine{238     \textcolor{comment}{!Finishing statement if writing file is successful.}}
\DoxyCodeLine{239     print *, \textcolor{stringliteral}{"Success in writing the NETCDF file: "}, filename}
\DoxyCodeLine{240     }

\end{DoxyCode}
\mbox{\Hypertarget{namespacewrite__file_a9e3b89277ccb10c11436a0847ec74c94}\label{namespacewrite__file_a9e3b89277ccb10c11436a0847ec74c94}} 
\index{write\_file@{write\_file}!xyz\_coords1d@{xyz\_coords1d}}
\index{xyz\_coords1d@{xyz\_coords1d}!write\_file@{write\_file}}
\doxysubsubsection{\texorpdfstring{xyz\_coords1d()}{xyz\_coords1d()}}
{\footnotesize\ttfamily subroutine write\+\_\+file\+::xyz\+\_\+coords1d (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{start,  }\item[{integer, intent(in)}]{endv }\end{DoxyParamCaption})}



Definition at line 415 of file netcdf\+\_\+file.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{415     }
\DoxyCodeLine{416     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: dp=kind(1.0d0)}
\DoxyCodeLine{417     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)} :: start, endv}
\DoxyCodeLine{418     \textcolor{comment}{!REAL(dp), INTENT(IN) :: bond\_len}}
\DoxyCodeLine{419     \textcolor{keywordtype}{INTEGER} :: i}
\DoxyCodeLine{420 \textcolor{keywordtype}{    REAL}(dp) :: a}
\DoxyCodeLine{421     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: file\_no=3}
\DoxyCodeLine{422 }
\DoxyCodeLine{423     \textcolor{keyword}{OPEN} (unit=file\_no,file=\textcolor{stringliteral}{"xyz1d.txt"},action=\textcolor{stringliteral}{"write"})}
\DoxyCodeLine{424     \textcolor{keywordflow}{DO} i=start,endv}
\DoxyCodeLine{425       a = (real(i) / (abs(start) + abs(endv))) * 2}
\DoxyCodeLine{426       \textcolor{keyword}{write} (file\_no,*) a,0,0}
\DoxyCodeLine{427 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{428   }
\DoxyCodeLine{429     \textcolor{keyword}{CLOSE} (file\_no)}
\DoxyCodeLine{430     print*, \textcolor{stringliteral}{'Success in writing: xyz1d.txt'}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacewrite__file_a414424a594a2b90fdc3b836c2ea4430e}\label{namespacewrite__file_a414424a594a2b90fdc3b836c2ea4430e}} 
\index{write\_file@{write\_file}!xyz\_coords2d@{xyz\_coords2d}}
\index{xyz\_coords2d@{xyz\_coords2d}!write\_file@{write\_file}}
\doxysubsubsection{\texorpdfstring{xyz\_coords2d()}{xyz\_coords2d()}}
{\footnotesize\ttfamily subroutine write\+\_\+file\+::xyz\+\_\+coords2d (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{start,  }\item[{integer, intent(in)}]{endv }\end{DoxyParamCaption})}



Definition at line 391 of file netcdf\+\_\+file.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{391     }
\DoxyCodeLine{392     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: dp=kind(1.0d0)}
\DoxyCodeLine{393     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)} :: start, endv}
\DoxyCodeLine{394     \textcolor{comment}{!REAL(dp), INTENT(IN) :: bond\_len}}
\DoxyCodeLine{395     \textcolor{keywordtype}{INTEGER} :: i,j}
\DoxyCodeLine{396 \textcolor{keywordtype}{    REAL}(dp) :: a, b}
\DoxyCodeLine{397     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: file\_no=3}
\DoxyCodeLine{398 }
\DoxyCodeLine{399     \textcolor{keyword}{OPEN} (unit=file\_no,file=\textcolor{stringliteral}{"xyz2d.txt"},action=\textcolor{stringliteral}{"write"})}
\DoxyCodeLine{400     \textcolor{keywordflow}{DO} i=start,endv}
\DoxyCodeLine{401       \textcolor{keywordflow}{DO} j=start,endv  }
\DoxyCodeLine{402         a =  (real(i) / (abs(start) + abs(endv)))*2}
\DoxyCodeLine{403         b =  (real(j) / (abs(start) + abs(endv)))*2}
\DoxyCodeLine{404         \textcolor{keyword}{write} (file\_no,*) a,b,0}
\DoxyCodeLine{405 \textcolor{keywordflow}{      END DO}}
\DoxyCodeLine{406 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{407   }
\DoxyCodeLine{408     \textcolor{keyword}{CLOSE} (file\_no)}
\DoxyCodeLine{409     print*, \textcolor{stringliteral}{'Success in writing: xyz2d.txt'}}

\end{DoxyCode}
\mbox{\Hypertarget{namespacewrite__file_a36860f626a8c46139a212edaf4d23a85}\label{namespacewrite__file_a36860f626a8c46139a212edaf4d23a85}} 
\index{write\_file@{write\_file}!xyz\_coords3d@{xyz\_coords3d}}
\index{xyz\_coords3d@{xyz\_coords3d}!write\_file@{write\_file}}
\doxysubsubsection{\texorpdfstring{xyz\_coords3d()}{xyz\_coords3d()}}
{\footnotesize\ttfamily subroutine write\+\_\+file\+::xyz\+\_\+coords3d (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{start,  }\item[{integer, intent(in)}]{endv }\end{DoxyParamCaption})}



xyz\+\_\+coords3d subroutine returns a 3 column text file named xyz3d.\+txt which contains the coordinates (x,y,z) in the order they where used for a given calculation. 

It corresponds to a full equally spaced 3D grid scaled to either -\/1,+1 for each axis for the 1 atom, or to -\/1.\+5 x bond length, 1.\+5 x bond length for the 2 atom system. @ 

Definition at line 365 of file netcdf\+\_\+file.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{365     }
\DoxyCodeLine{366     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: dp=kind(1.0d0)}
\DoxyCodeLine{367     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{INTENT(IN)} :: start, endv}
\DoxyCodeLine{368     \textcolor{keywordtype}{INTEGER} :: i,j,k}
\DoxyCodeLine{369 \textcolor{keywordtype}{    REAL}(dp) :: a,b,c}
\DoxyCodeLine{370     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: file\_no=3}
\DoxyCodeLine{371 }
\DoxyCodeLine{372     \textcolor{keyword}{OPEN} (unit=file\_no,file=\textcolor{stringliteral}{"xyz3d.txt"},action=\textcolor{stringliteral}{"write"})}
\DoxyCodeLine{373     \textcolor{keywordflow}{DO} i=start,endv}
\DoxyCodeLine{374       \textcolor{keywordflow}{DO} j=start,endv}
\DoxyCodeLine{375         \textcolor{keywordflow}{DO} k=start,endv}
\DoxyCodeLine{376           a =  (real(i) / (abs(start) + abs(endv))) *2}
\DoxyCodeLine{377           b =  (real(j) / (abs(start) + abs(endv))) *2}
\DoxyCodeLine{378           c =  (real(k) / (abs(start) + abs(endv))) *2}
\DoxyCodeLine{379           \textcolor{keyword}{write} (file\_no,*) a,b,c}
\DoxyCodeLine{380 \textcolor{keywordflow}{        END DO}}
\DoxyCodeLine{381 \textcolor{keywordflow}{      END DO}}
\DoxyCodeLine{382 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{383   }
\DoxyCodeLine{384     \textcolor{keyword}{CLOSE} (file\_no)}
\DoxyCodeLine{385     print*, \textcolor{stringliteral}{'Success in writing: xyz3d.txt'}}

\end{DoxyCode}
