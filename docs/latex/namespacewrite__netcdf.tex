\hypertarget{namespacewrite__netcdf}{}\doxysubsection{write\+\_\+netcdf Module Reference}
\label{namespacewrite__netcdf}\index{write\_netcdf@{write\_netcdf}}
\doxysubsubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespacewrite__netcdf_a0ea39e88fd96a7404a63c66160395510}{write\+\_\+data}} (grid\+\_\+final, grid\+\_\+init, mag, xaxis, yaxis, taxis, init, beta, J, filename, ierr)
\end{DoxyCompactItemize}


\doxysubsubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacewrite__netcdf_a0ea39e88fd96a7404a63c66160395510}\label{namespacewrite__netcdf_a0ea39e88fd96a7404a63c66160395510}} 
\index{write\_netcdf@{write\_netcdf}!write\_data@{write\_data}}
\index{write\_data@{write\_data}!write\_netcdf@{write\_netcdf}}
\doxyparagraph{\texorpdfstring{write\_data()}{write\_data()}}
{\footnotesize\ttfamily subroutine write\+\_\+netcdf\+::write\+\_\+data (\begin{DoxyParamCaption}\item[{integer(int32), dimension(\+:,\+:), intent(in)}]{grid\+\_\+final,  }\item[{integer(int32), dimension(\+:,\+:), intent(in)}]{grid\+\_\+init,  }\item[{real(real64), dimension(\+:), intent(in)}]{mag,  }\item[{integer(int32), dimension(\+:), intent(in)}]{xaxis,  }\item[{integer(int32), dimension(\+:), intent(in)}]{yaxis,  }\item[{integer(int32), dimension(\+:), intent(in)}]{taxis,  }\item[{character(len=5), intent(in)}]{init,  }\item[{real(real64), intent(in)}]{beta,  }\item[{real(real64), intent(in)}]{J,  }\item[{character(len=$\ast$), intent(in)}]{filename,  }\item[{integer(int32)}]{ierr }\end{DoxyParamCaption})}



Definition at line 16 of file write\+\_\+netcdf.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{16 }
\DoxyCodeLine{17     \textcolor{comment}{! Declaring the axes/variables that will written to the file}}
\DoxyCodeLine{18     \textcolor{keywordtype}{INTEGER(INT32)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{DIMENSION(:,:)} :: grid\_final, grid\_init}
\DoxyCodeLine{19     \textcolor{keywordtype}{INTEGER(INT32)}, \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{DIMENSION(:)} :: xaxis, yaxis, taxis}
\DoxyCodeLine{20 \textcolor{keywordtype}{    REAL}(REAL64), \textcolor{keywordtype}{INTENT(IN)}, \textcolor{keywordtype}{DIMENSION(:)} :: mag}
\DoxyCodeLine{21 }
\DoxyCodeLine{22     \textcolor{comment}{! Declaring the variables that will be  as global attributes}}
\DoxyCodeLine{23 \textcolor{keywordtype}{    REAL}(REAL64), \textcolor{keywordtype}{INTENT(IN)} :: beta, J}
\DoxyCodeLine{24     \textcolor{keywordtype}{CHARACTER(LEN=5)}, \textcolor{keywordtype}{INTENT(IN)} :: init}
\DoxyCodeLine{25 }
\DoxyCodeLine{26     \textcolor{comment}{! Parameters representing the rank our variables, useful}}
\DoxyCodeLine{27     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: ndims = 2, tdims = 1}
\DoxyCodeLine{28 }
\DoxyCodeLine{29     \textcolor{comment}{! Declaring the variables sizes, sizet that store the numerical lengths of}}
\DoxyCodeLine{30     \textcolor{comment}{! our variables and the variable dim\_ids which store the dimension ids for}}
\DoxyCodeLine{31     \textcolor{comment}{! our grid data}}
\DoxyCodeLine{32     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(ndims)} :: sizes, dim\_ids}
\DoxyCodeLine{33     \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{DIMENSION(tdims)} :: sizet}
\DoxyCodeLine{34 }
\DoxyCodeLine{35     \textcolor{comment}{! Declaring string names for the dimensions of our variables}}
\DoxyCodeLine{36     \textcolor{keywordtype}{CHARACTER(LEN=1)}, \textcolor{keywordtype}{DIMENSION(ndims)} :: dims=(/\textcolor{stringliteral}{"x"}, \textcolor{stringliteral}{"y"}/)}
\DoxyCodeLine{37     \textcolor{keywordtype}{CHARACTER(LEN=1)} :: dimt = \textcolor{stringliteral}{"t"}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39     \textcolor{comment}{! Declaring the variable ids for each of our variables}}
\DoxyCodeLine{40     \textcolor{keywordtype}{INTEGER(INT32)} :: x\_id, y\_id, t\_id, file\_id, dim\_idt}
\DoxyCodeLine{41     \textcolor{keywordtype}{INTEGER(INT32)} :: grid\_final\_id, grid\_init\_id, mag\_id}
\DoxyCodeLine{42 }
\DoxyCodeLine{43     \textcolor{keywordtype}{CHARACTER(LEN=*)}, \textcolor{keywordtype}{INTENT(IN)} :: filename}
\DoxyCodeLine{44     \textcolor{keywordtype}{INTEGER(INT32)} :: ierr, i}
\DoxyCodeLine{45 }
\DoxyCodeLine{46     \textcolor{comment}{! Obtain the dimensions of our variables}}
\DoxyCodeLine{47     sizes = shape(grid\_final)}
\DoxyCodeLine{48     sizet = shape(taxis)}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{comment}{! Create the netCDF file, overwriting a file if it has the same name}}
\DoxyCodeLine{51     ierr = nf90\_create(filename, nf90\_clobber, file\_id)}
\DoxyCodeLine{52     \textcolor{comment}{! This indicates a writing step error, prompting a return from subroutine}}
\DoxyCodeLine{53     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{54       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{55       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{56 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{57 }
\DoxyCodeLine{58     \textcolor{comment}{! We define the dimensions for anything related to the grid here}}
\DoxyCodeLine{59     \textcolor{comment}{! These dimensions are used for the rank 2 arrays and their axes}}
\DoxyCodeLine{60     \textcolor{keywordflow}{DO} i = 1, ndims}
\DoxyCodeLine{61       ierr = nf90\_def\_dim(file\_id, dims(i), sizes(i), dim\_ids(i))}
\DoxyCodeLine{62       \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{63         print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{64         \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{65 \textcolor{keywordflow}{      END IF}}
\DoxyCodeLine{66 \textcolor{keywordflow}{    END DO}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{comment}{! We define the dimension of the magnetization and its axis here}}
\DoxyCodeLine{69     ierr = nf90\_def\_dim(file\_id, dimt, sizet(1), dim\_idt)}
\DoxyCodeLine{70     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{71       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{72       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{73 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{comment}{! Define the variable types for our axes for x, y and t, respectively}}
\DoxyCodeLine{76     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"x"}, nf90\_int, dim\_ids(1), x\_id)}
\DoxyCodeLine{77     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{78       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{79       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{80 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"y"}, nf90\_int, dim\_ids(2), y\_id)}
\DoxyCodeLine{83     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{84       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{85       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{86 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{87 }
\DoxyCodeLine{88     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"t"}, nf90\_int, dim\_idt, t\_id)}
\DoxyCodeLine{89     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{90       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{91       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{92 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{93 }
\DoxyCodeLine{94     \textcolor{comment}{! Define the variable types for our three Ising model variables}}
\DoxyCodeLine{95     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"final\_grid"}, nf90\_int, dim\_ids, grid\_final\_id)}
\DoxyCodeLine{96     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{97       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{98       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{99 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{100 }
\DoxyCodeLine{101     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"initial\_grid"}, nf90\_int, dim\_ids, grid\_init\_id)}
\DoxyCodeLine{102     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{103       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{104       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{105 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{106 }
\DoxyCodeLine{107     ierr = nf90\_def\_var(file\_id, \textcolor{stringliteral}{"net\_magnetization"}, nf90\_real, dim\_idt, mag\_id)}
\DoxyCodeLine{108     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{109       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{110       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{111 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{comment}{! Adding global attribute describing data}}
\DoxyCodeLine{114     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"Description"}, \textcolor{stringliteral}{"Initial grid, final \&}}
\DoxyCodeLine{115 \textcolor{stringliteral}{}\textcolor{stringliteral}{    \&grid after T\_timesteps and net magnetization history for Ising model simulation, \&}}
\DoxyCodeLine{116 \textcolor{stringliteral}{}\textcolor{stringliteral}{    \& program file names and command line input given below."})}
\DoxyCodeLine{117     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{118       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{119       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{120 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{121 }
\DoxyCodeLine{122     \textcolor{comment}{! Adding global attribute listing the code files used for simulation}}
\DoxyCodeLine{123     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"CodeFiles"}, \textcolor{stringliteral}{"ising.f90, sweetener.f90, \&}}
\DoxyCodeLine{124 \textcolor{stringliteral}{}\textcolor{stringliteral}{    \& write\_netcdf.f90, command\_line.f90, random\_mod.f90, ising.sh"})}
\DoxyCodeLine{125     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{126       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{127       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{128 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{129 }
\DoxyCodeLine{130     \textcolor{comment}{! Add global attributes consisting of our five run data items}}
\DoxyCodeLine{131     \textcolor{comment}{! This includes the total iterations}}
\DoxyCodeLine{132     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"N\_gridsize"}, sizes(1))}
\DoxyCodeLine{133     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{134       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{135       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{136 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{137 }
\DoxyCodeLine{138     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"T\_timesteps"}, sizet(1)-\/1)}
\DoxyCodeLine{139     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{140       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{141       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{142 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{143 }
\DoxyCodeLine{144     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"init\_config"}, init)}
\DoxyCodeLine{145     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{146       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{147       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{148 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{149 }
\DoxyCodeLine{150     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"beta\_temp"}, beta)}
\DoxyCodeLine{151     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{152       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{153       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{154 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{155 }
\DoxyCodeLine{156     ierr = nf90\_put\_att(file\_id, nf90\_global, \textcolor{stringliteral}{"J\_interstr"}, j)}
\DoxyCodeLine{157     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{158       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{159       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{160 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162     \textcolor{comment}{! Finish metadata definitions}}
\DoxyCodeLine{163     ierr = nf90\_enddef(file\_id)}
\DoxyCodeLine{164     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{165       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{166       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{167 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169     \textcolor{comment}{! Write the three axes to file}}
\DoxyCodeLine{170     ierr = nf90\_put\_var(file\_id, x\_id, xaxis)}
\DoxyCodeLine{171     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{172       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{173       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{174 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{175 }
\DoxyCodeLine{176     ierr = nf90\_put\_var(file\_id, y\_id, yaxis)}
\DoxyCodeLine{177     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{178       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{179       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{180 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{181 }
\DoxyCodeLine{182     ierr = nf90\_put\_var(file\_id, t\_id, taxis)}
\DoxyCodeLine{183     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{184       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{185       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{186 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188     \textcolor{comment}{! Write the final grid state}}
\DoxyCodeLine{189     ierr = nf90\_put\_var(file\_id, grid\_final\_id, grid\_final)}
\DoxyCodeLine{190     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{191       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{192       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{193 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{194 }
\DoxyCodeLine{195     \textcolor{comment}{! Write the final grid state}}
\DoxyCodeLine{196     ierr = nf90\_put\_var(file\_id, grid\_init\_id, grid\_init)}
\DoxyCodeLine{197     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{198       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{199       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{200 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202     \textcolor{comment}{! Write magnetization}}
\DoxyCodeLine{203     ierr = nf90\_put\_var(file\_id, mag\_id, mag)}
\DoxyCodeLine{204     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{205       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{206       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{207 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209     \textcolor{comment}{! Close the file}}
\DoxyCodeLine{210     ierr = nf90\_close(file\_id)}
\DoxyCodeLine{211     \textcolor{keywordflow}{IF} (ierr /= nf90\_noerr) \textcolor{keywordflow}{THEN}}
\DoxyCodeLine{212       print*, trim(nf90\_strerror(ierr))}
\DoxyCodeLine{213       \textcolor{keywordflow}{RETURN}}
\DoxyCodeLine{214 \textcolor{keywordflow}{    END IF}}
\DoxyCodeLine{215 }

\end{DoxyCode}


Referenced by main().

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=291pt]{namespacewrite__netcdf_a0ea39e88fd96a7404a63c66160395510_icgraph}
\end{center}
\end{figure}
