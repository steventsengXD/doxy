<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PX 915 Project Title/Name Here: basis_functions Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PX 915 Project Title/Name Here
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacebasis__functions.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">basis_functions Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Wavefunction, hamiltonian and basis set choice.  
<a href="namespacebasis__functions.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a2b1743e80170bccff87171f1695bf9a3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3">initialise_basis</a> (n_electrons_in, n_basis_functions_per_atom_in, n_atoms_in, atom_coords_in, n_Jastrow_in, fd_length_in, Jastrow_b_length_in, Jastrow_d_length_in, proton_numbers_in, basis_type_in)</td></tr>
<tr class="memdesc:a2b1743e80170bccff87171f1695bf9a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialisation routine.  <a href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3">More...</a><br /></td></tr>
<tr class="separator:a2b1743e80170bccff87171f1695bf9a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ef39e7df0f40c27616e9719cef10dc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a13ef39e7df0f40c27616e9719cef10dc">deinitialise_basis</a></td></tr>
<tr class="memdesc:a13ef39e7df0f40c27616e9719cef10dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dinitialisation routine.  <a href="namespacebasis__functions.html#a13ef39e7df0f40c27616e9719cef10dc">More...</a><br /></td></tr>
<tr class="separator:a13ef39e7df0f40c27616e9719cef10dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9aa926890ee9ca588ab8439095de68d"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ac9aa926890ee9ca588ab8439095de68d">wave_function_slater_1s</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:ac9aa926890ee9ca588ab8439095de68d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single Electron wavefunction: slater 1s basis.  <a href="namespacebasis__functions.html#ac9aa926890ee9ca588ab8439095de68d">More...</a><br /></td></tr>
<tr class="separator:ac9aa926890ee9ca588ab8439095de68d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a341dddb966f7d491ad3ffa90d862156f"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a341dddb966f7d491ad3ffa90d862156f">reduced_hamiltonian_slater_1s</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:a341dddb966f7d491ad3ffa90d862156f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single Electron Reduced Hamiltonian: slater 1s basis.  <a href="namespacebasis__functions.html#a341dddb966f7d491ad3ffa90d862156f">More...</a><br /></td></tr>
<tr class="separator:a341dddb966f7d491ad3ffa90d862156f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa2ed47c325e9955b40da5b344fd31a"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a3aa2ed47c325e9955b40da5b344fd31a">discrete_laplacian_reduced</a> (position, h, dofs)</td></tr>
<tr class="memdesc:a3aa2ed47c325e9955b40da5b344fd31a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finite Difference Reduced Laplacian Computes finite difference approximation to the reduced laplacian $(\nabla^2\psi)/\psi$.  <a href="namespacebasis__functions.html#a3aa2ed47c325e9955b40da5b344fd31a">More...</a><br /></td></tr>
<tr class="separator:a3aa2ed47c325e9955b40da5b344fd31a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f59f9576cb02ba4361bf7dc5046ce5d"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a1f59f9576cb02ba4361bf7dc5046ce5d">wave_function_2_electrons</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:a1f59f9576cb02ba4361bf7dc5046ce5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wavefunction for 2 electrons.  <a href="namespacebasis__functions.html#a1f59f9576cb02ba4361bf7dc5046ce5d">More...</a><br /></td></tr>
<tr class="separator:a1f59f9576cb02ba4361bf7dc5046ce5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea41a868e0e1522cb6d3e3ed1b52d66"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#acea41a868e0e1522cb6d3e3ed1b52d66">reduced_hamiltonian_2_electrons</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:acea41a868e0e1522cb6d3e3ed1b52d66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reduced Hamiltonian for 2 electrons.  <a href="namespacebasis__functions.html#acea41a868e0e1522cb6d3e3ed1b52d66">More...</a><br /></td></tr>
<tr class="separator:acea41a868e0e1522cb6d3e3ed1b52d66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e84ba132fa13988d8882ae21a781832"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a0e84ba132fa13988d8882ae21a781832">mno_allocate</a> (n_terms)</td></tr>
<tr class="memdesc:a0e84ba132fa13988d8882ae21a781832"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate parameters for Jastrow factor.  <a href="namespacebasis__functions.html#a0e84ba132fa13988d8882ae21a781832">More...</a><br /></td></tr>
<tr class="separator:a0e84ba132fa13988d8882ae21a781832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad155a8bce0b153e59bfef25f0d7e6e1f"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ad155a8bce0b153e59bfef25f0d7e6e1f">log_density</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:ad155a8bce0b153e59bfef25f0d7e6e1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Log of the Probability Density.  <a href="namespacebasis__functions.html#ad155a8bce0b153e59bfef25f0d7e6e1f">More...</a><br /></td></tr>
<tr class="separator:ad155a8bce0b153e59bfef25f0d7e6e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdeef21beca62feb10d5f5057e30c342"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#acdeef21beca62feb10d5f5057e30c342">wave_function_sto3g</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:acdeef21beca62feb10d5f5057e30c342"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single Electron wavefunction: gaussian sto3g basis.  <a href="namespacebasis__functions.html#acdeef21beca62feb10d5f5057e30c342">More...</a><br /></td></tr>
<tr class="separator:acdeef21beca62feb10d5f5057e30c342"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dd883f5d1f574a78c3266f0ce627eb8"><td class="memItemLeft" align="right" valign="top">real(dp) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a6dd883f5d1f574a78c3266f0ce627eb8">reduced_hamiltonian_sto3g</a> (position, dof_coefficients)</td></tr>
<tr class="memdesc:a6dd883f5d1f574a78c3266f0ce627eb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Single Electron Reduced Hamiltonian: gaussian sto3g basis.  <a href="namespacebasis__functions.html#a6dd883f5d1f574a78c3266f0ce627eb8">More...</a><br /></td></tr>
<tr class="separator:a6dd883f5d1f574a78c3266f0ce627eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5176e9e5598bd13047a4c720fbc37c50"><td class="memItemLeft" align="right" valign="top">procedure(<a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a>), pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a5176e9e5598bd13047a4c720fbc37c50">wave_function</a></td></tr>
<tr class="separator:a5176e9e5598bd13047a4c720fbc37c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9981898fc0fed9c10945781e26917b1"><td class="memItemLeft" align="right" valign="top">procedure(<a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a>), pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ab9981898fc0fed9c10945781e26917b1">reduced_hamiltonian</a></td></tr>
<tr class="separator:ab9981898fc0fed9c10945781e26917b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33299211b5f4167aa20494965e6df6fe"><td class="memItemLeft" align="right" valign="top">logical, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a33299211b5f4167aa20494965e6df6fe">initialised</a> = .false.</td></tr>
<tr class="separator:a33299211b5f4167aa20494965e6df6fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4dfb3b99da7a98dfb63e70865a1ee29"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ad4dfb3b99da7a98dfb63e70865a1ee29">n_electrons</a></td></tr>
<tr class="separator:ad4dfb3b99da7a98dfb63e70865a1ee29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9fb7e7b9af3e057ec02a2feb7368b8e"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ac9fb7e7b9af3e057ec02a2feb7368b8e">n_basis_functions_per_atom</a></td></tr>
<tr class="separator:ac9fb7e7b9af3e057ec02a2feb7368b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a106093181d8f73b5757e18bed45354"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a7a106093181d8f73b5757e18bed45354">n_atoms</a></td></tr>
<tr class="separator:a7a106093181d8f73b5757e18bed45354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2433e6f0971d508142a511c8d87c30b"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:,:), allocatable, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ae2433e6f0971d508142a511c8d87c30b">atom_coords</a></td></tr>
<tr class="separator:ae2433e6f0971d508142a511c8d87c30b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8eaad13ee1fa3799c55ff4fe1dc48b5"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ac8eaad13ee1fa3799c55ff4fe1dc48b5">n_jastrow_dofs</a></td></tr>
<tr class="separator:ac8eaad13ee1fa3799c55ff4fe1dc48b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8114bf21770f69fbbc228d14a9c2bf4"><td class="memItemLeft" align="right" valign="top">real(dp), protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ac8114bf21770f69fbbc228d14a9c2bf4">fd_h</a></td></tr>
<tr class="separator:ac8114bf21770f69fbbc228d14a9c2bf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a981aa8fc3a64198138bccb0413dacc94"><td class="memItemLeft" align="right" valign="top">real(dp), protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a981aa8fc3a64198138bccb0413dacc94">b_length</a></td></tr>
<tr class="separator:a981aa8fc3a64198138bccb0413dacc94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f3a451d100c71d40dcfced3b16334e4"><td class="memItemLeft" align="right" valign="top">real(dp), protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a0f3a451d100c71d40dcfced3b16334e4">d_length</a></td></tr>
<tr class="separator:a0f3a451d100c71d40dcfced3b16334e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7936f84f27dc052e58eb470bc220fb85"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), allocatable, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a7936f84f27dc052e58eb470bc220fb85">proton_numbers</a></td></tr>
<tr class="separator:a7936f84f27dc052e58eb470bc220fb85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c148eb124b16f4ce8a5c822b7ef30f4"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a9c148eb124b16f4ce8a5c822b7ef30f4">basis_type</a></td></tr>
<tr class="separator:a9c148eb124b16f4ce8a5c822b7ef30f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b525380de9887a3919e23b5fd03e75"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a79b525380de9887a3919e23b5fd03e75">number_dofs</a></td></tr>
<tr class="separator:a79b525380de9887a3919e23b5fd03e75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2e0cf4f62dc5afc6f91a283ba3f055e"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#aa2e0cf4f62dc5afc6f91a283ba3f055e">n_space_dims</a></td></tr>
<tr class="separator:aa2e0cf4f62dc5afc6f91a283ba3f055e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4fc66a8a927069f6788785e3ade0ff3"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:,:), allocatable, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#ad4fc66a8a927069f6788785e3ade0ff3">dof_bounds</a></td></tr>
<tr class="separator:ad4fc66a8a927069f6788785e3ade0ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc655d1e5dbccbd5fa2598c80dcb673"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a3fc655d1e5dbccbd5fa2598c80dcb673">n_dofs_per_atom</a></td></tr>
<tr class="separator:a3fc655d1e5dbccbd5fa2598c80dcb673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a931089e272b9708ea78e4e84774e6491"><td class="memItemLeft" align="right" valign="top">integer, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a931089e272b9708ea78e4e84774e6491">n_dofs_no_jastrow</a></td></tr>
<tr class="separator:a931089e272b9708ea78e4e84774e6491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6153b94101ca52c60301c014e8018cd3"><td class="memItemLeft" align="right" valign="top">integer, dimension(:,:), allocatable, protected&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a6153b94101ca52c60301c014e8018cd3">mno_parameters</a></td></tr>
<tr class="separator:a6153b94101ca52c60301c014e8018cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c617d7a4f11173571c4e29000df9a1a"><td class="memItemLeft" align="right" valign="top">procedure(<a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a>), pointer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasis__functions.html#a0c617d7a4f11173571c4e29000df9a1a">wave_function_single</a></td></tr>
<tr class="separator:a0c617d7a4f11173571c4e29000df9a1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Wavefunction, hamiltonian and basis set choice. </p>
<p>This module contains functions that define the hamiltonian that specifies the problem and the basis set being used. Makes significant use of module variables defined in an initialisation subroutine. This allocates 2 function pointers using <a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a></p><ul>
<li><a class="el" href="namespacebasis__functions.html#a5176e9e5598bd13047a4c720fbc37c50">wave_function</a></li>
<li><a class="el" href="namespacebasis__functions.html#ab9981898fc0fed9c10945781e26917b1">reduced_hamiltonian</a> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">position</td><td>a real(dp) array of electron coordinates </td></tr>
    <tr><td class="paramname">dof_coefficients</td><td>a real(dp) array of degree of freedom (dof) parameters These are the only functions that should be used outside of the module. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a13ef39e7df0f40c27616e9719cef10dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13ef39e7df0f40c27616e9719cef10dc">&#9670;&nbsp;</a></span>deinitialise_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine basis_functions::deinitialise_basis</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dinitialisation routine. </p>
<p>MUST be run at the end of main program to deallocate module variables. </p>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00267">267</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (initialised) <span class="keyword">deallocate</span>(dof_bounds,atom_coords,proton_numbers)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">allocated</span>(mno_parameters)) <span class="keyword">deallocate</span>(mno_parameters)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    initialised = .false.</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="basis__functions_8f90_source.html#l00052">dof_bounds</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00057">mno_parameters</a>, and <a class="el" href="basis__functions_8f90_source.html#l00047">proton_numbers</a>.</p>

<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, <a class="el" href="Biased__Optim__example__driver_8f90_source.html#l00021">main()</a>, and <a class="el" href="ed__test_8f90_source.html#l00001">main_driver()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a13ef39e7df0f40c27616e9719cef10dc_icgraph.png" border="0" usemap="#namespacebasis__functions_a13ef39e7df0f40c27616e9719cef10dc_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a13ef39e7df0f40c27616e9719cef10dc_icgraph" id="namespacebasis__functions_a13ef39e7df0f40c27616e9719cef10dc_icgraph">
<area shape="rect" title="Dinitialisation routine." alt="" coords="200,49,403,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="a3aa2ed47c325e9955b40da5b344fd31a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa2ed47c325e9955b40da5b344fd31a">&#9670;&nbsp;</a></span>discrete_laplacian_reduced()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::discrete_laplacian_reduced </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dofs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finite Difference Reduced Laplacian Computes finite difference approximation to the reduced laplacian $(\nabla^2\psi)/\psi$. </p>
<p>Uses that $f''(x)/f(x) =((f(x+h)+f(x-h))/f(x)-2)/(h^2)+O(h^2)$ (*) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Finite difference lengthscale </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dofs</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00368">368</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="keywordtype">    real</span>(dp) :: discrete_Laplacian_reduced</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">intent(in)</span> :: h </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dofs </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordtype">integer</span> :: i <span class="comment">! Loop variable</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: delta <span class="comment">! temporary array for vector displacements</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      stop</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.n_space_dims) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted&quot;</span>, n_space_dims</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      stop</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dofs).ne.number_dofs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dofs), <span class="stringliteral">&quot;wanted&quot;</span>, number_dofs</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      stop</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">! Create matrix of cartesian basis vectors of length h. Set as 0 initially, h added during main loop</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">allocate</span>(delta(n_space_dims,n_space_dims))</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    delta = 0.0_dp <span class="comment">! Matrix assignment</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    discrete_laplacian_reduced = 0.0_dp</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">do</span> i = 1, n_space_dims <span class="comment">! Loop over space dimensions</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      delta(i,i) = h </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      discrete_laplacian_reduced = discrete_laplacian_reduced &amp;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">! Following (*), sum of (f(x+h)+f(x-h)) in all space dimensions</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      + wave_function(position + delta(:,i), dofs) + wave_function(position - delta(:,i), dofs)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="keywordflow">    end do</span> </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">! Following (*), divide by $f(x)$, and subtract 2 for each space dimension</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    discrete_laplacian_reduced = discrete_laplacian_reduced/wave_function(position ,dofs) - 2*n_space_dims</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">! Following (*), divide by h^2</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    discrete_laplacian_reduced = discrete_laplacian_reduced/(h**2)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">! deallocate temporary array</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">deallocate</span>(delta)</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00051">n_space_dims</a>, <a class="el" href="basis__functions_8f90_source.html#l00050">number_dofs</a>, and <a class="el" href="basis__functions_8f90_source.html#l00020">wave_function</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a3aa2ed47c325e9955b40da5b344fd31a_icgraph.png" border="0" usemap="#namespacebasis__functions_a3aa2ed47c325e9955b40da5b344fd31a_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a3aa2ed47c325e9955b40da5b344fd31a_icgraph" id="namespacebasis__functions_a3aa2ed47c325e9955b40da5b344fd31a_icgraph">
<area shape="rect" title="Finite Difference Reduced Laplacian Computes finite difference approximation to the reduced laplacian..." alt="" coords="672,49,855,90"/>
<area shape="rect" href="namespacebasis__functions.html#acea41a868e0e1522cb6d3e3ed1b52d66" title="Reduced Hamiltonian for 2 electrons." alt="" coords="435,49,624,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="a2b1743e80170bccff87171f1695bf9a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b1743e80170bccff87171f1695bf9a3">&#9670;&nbsp;</a></span>initialise_basis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine basis_functions::initialise_basis </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_electrons_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_basis_functions_per_atom_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_atoms_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>atom_coords_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>n_Jastrow_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in), optional&#160;</td>
          <td class="paramname"><em>fd_length_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in), optional&#160;</td>
          <td class="paramname"><em>Jastrow_b_length_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in), optional&#160;</td>
          <td class="paramname"><em>Jastrow_d_length_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>proton_numbers_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>basis_type_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialisation routine. </p>
<p>Must be run at the start of the main program, after user input. This defines the problem and selects the basis being used. It allocates module variables and procedure pointers. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_electrons_in</td><td>Number of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_basis_functions_per_atom_in</td><td>Number of linear terms in the single-electron wavefunction per atom </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_atoms_in</td><td>Number of atoms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">atom_coords_in</td><td>Coordinates of the atoms. Shape (3,n_atoms) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_jastrow_in</td><td>Number of dofs in the Jastrow (interaction) term </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fd_length_in</td><td>Lengthscale of the finite difference code </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jastrow_b_length_in</td><td>Inverse lengthscale of nuclear-electron interaction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jastrow_d_length_in</td><td>Inverse lengthscale of electron-electron interaction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">proton_numbers_in</td><td>Proton Numbers of atoms </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">basis_type_in</td><td>integer code for type of basis. Codes are listed in shared_constants.f90 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00069">69</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">! Required Parameters</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n_electrons_in </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n_basis_functions_per_atom_in </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: n_atoms_in </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">intent(in)</span> :: atom_coords_in </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">! Optional Paramters</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: n_Jastrow_in </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: fd_length_in </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: Jastrow_b_length_in</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: Jastrow_d_length_in</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: proton_numbers_in </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">integer</span>, <span class="keywordtype">optional</span>, <span class="keywordtype">intent(in)</span> :: basis_type_in </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">! Internal Variables</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">integer</span> :: i <span class="comment">! Loop variable</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">integer</span> :: n_dofs_per_basis_function <span class="comment">! number of dofs per linear term of the wavefunction. Always 2 for slater and Gaussian</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">! Check not already initialised</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (initialised) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      print *, <span class="stringliteral">&quot;Error, cannot initialise basis twice&quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      stop</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">if</span> (n_atoms_in &lt;= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      print*,<span class="stringliteral">&quot;Error, number of atoms must be positive&quot;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      stop</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> ((n_atoms_in .ne. 1).and.(n_atoms_in .ne. 2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      print*,<span class="stringliteral">&quot;Error, only 1 or 2 atoms supported&quot;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      stop</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    n_atoms = n_atoms_in</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">! Check and allocate the atom coordinates</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(atom_coords_in,2) .ne. n_atoms_in ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      print*,<span class="stringliteral">&quot;Error, wrong number of atoms&quot;</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      stop</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(atom_coords_in,1) .ne. 3 ) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      print*,<span class="stringliteral">&quot;Error, wrong dimension of atom coordinates&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      stop</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">allocate</span>(atom_coords(3,<span class="keyword">size</span>(atom_coords_in,2)))</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    atom_coords = atom_coords_in</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">! Check and assign other required inputs</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">if</span> (n_basis_functions_per_atom_in &lt;= 0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      print*,<span class="stringliteral">&quot;Error, number of basis functions per atom must be positive&quot;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      stop</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    n_basis_functions_per_atom = n_basis_functions_per_atom_in</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> ((n_electrons_in .ne. 1).and.(n_electrons_in .ne. 2)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      print*,<span class="stringliteral">&quot;Error, number of electrons must be 1 or 2&quot;</span> </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      stop</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    n_electrons = n_electrons_in</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    n_space_dims = 3*n_electrons</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">! Check and assign optional paramters</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(n_jastrow_in)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      n_jastrow_dofs = n_jastrow_in</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      n_jastrow_dofs = 7 <span class="comment">! Default Value</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(fd_length_in)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">if</span> (fd_length_in&gt;0.00009) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        fd_h = fd_length_in</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        print*, <span class="stringliteral">&quot;Error, finite difference length must be at least 0.0001&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        stop</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      fd_h = 0.01_dp <span class="comment">! Default Value</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(jastrow_b_length_in)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span> (jastrow_b_length_in&gt;0.05) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        b_length = jastrow_b_length_in</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        print*, <span class="stringliteral">&quot;Error, Jastrow b length must be positive&quot;</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        stop</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      b_length = 1.0_dp <span class="comment">! Default value</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(jastrow_d_length_in)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (jastrow_d_length_in&gt;0.05) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        d_length = jastrow_d_length_in</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        print*, <span class="stringliteral">&quot;Error, Jastrow d length must be positive&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        stop</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      d_length = 1.0_dp <span class="comment">! Default value</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keyword">allocate</span>(proton_numbers(n_atoms))</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">present</span>(proton_numbers_in)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">if</span> (<span class="keyword">size</span>(proton_numbers_in)==n_atoms) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        proton_numbers = proton_numbers_in</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">else</span> </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        print*, <span class="stringliteral">&quot;Error, mismatch in number of atoms and proton numbers&quot;</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        stop</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      proton_numbers = 1.0_dp <span class="comment">! Default value is hydrogen</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">present</span>(basis_type_in)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      basis_type = basis_type_in</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      basis_type = slater_1s_code <span class="comment">!Default basis set</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">! Assign individual electron wavefunction with input basis set</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">select case</span>(basis_type)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">case</span> (slater_1s_code)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      wave_function_single =&gt; wave_function_slater_1s</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      reduced_hamiltonian =&gt; reduced_hamiltonian_slater_1s</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">case</span> (sto_3g_code)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      wave_function_single =&gt; wave_function_sto3g</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      reduced_hamiltonian =&gt; reduced_hamiltonian_sto3g</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">    case default</span> </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      print *, <span class="stringliteral">&quot;Basis type not recognised&quot;</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      stop</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keywordflow">    end select</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">! Set number of dofs per basis function. This may change for future choices of basis sets</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    n_dofs_per_basis_function = 2</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    n_dofs_per_atom = n_dofs_per_basis_function * n_basis_functions_per_atom </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    n_dofs_no_jastrow = n_dofs_per_atom * n_atoms </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">! Assignments for one electron, slater type orbital</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (n_electrons_in .eq. 1) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      number_dofs = n_dofs_per_atom * n_atoms</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      <span class="keyword">allocate</span>(dof_bounds(number_dofs,2))</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="comment">! Assign dof bounds for single electron part</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">! Ordering here is for 2 dofs per basis function, in pairs, first linear dof then width dof</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="keywordflow">do</span> i = 1, n_basis_functions_per_atom*n_atoms <span class="comment">! Loop over pairs of dofs</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          dof_bounds(2*i-1,:)=[-1.5_dp,1.5_dp] <span class="comment">! Linear coeffs defaults -1.5 to 1.5</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;          dof_bounds(2*i,:)=[0.1_dp,1.5_dp]   <span class="comment">! width positive, up to 1.5 </span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">! Assign wave_function pointer. Ham pointer already assigned</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      wave_function =&gt; wave_function_single</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">! Assignments for 2 electrons, slater type orbital</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (n_electrons_in .eq. 2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="comment">! Allocate the mno parameters that determine the form of Jastrow term</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="keyword">call </span>mno_allocate(n_jastrow_dofs)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      number_dofs = n_dofs_per_atom * n_atoms + n_jastrow_dofs</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keyword">allocate</span>(dof_bounds(number_dofs,2))</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="comment">! Assign dof bounds</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="comment">! Ordering here is for 2 dofs per basis function, first linear cooef then width coeff</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="keywordflow">do</span> i = 1,n_basis_functions_per_atom*n_atoms <span class="comment">! Loop over pairs of dofs</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          dof_bounds(2*i-1,:)=[-1.5_dp,1.5_dp] <span class="comment">! Linear coeffs bounds -1.5 to 1.5</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          dof_bounds(2*i,:)=[0.1_dp,1.5_dp]   <span class="comment">! width positive, up to 1.5 </span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <span class="keywordflow">if</span> (n_jastrow_dofs.ne.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">do</span> i = n_dofs_per_atom*n_atoms+1, number_dofs</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          dof_bounds(i,:) = [-1.5_dp,1.5_dp] <span class="comment">! Jastrow dofs bounds -1.5 to 1.5</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="keywordflow">        end do</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keywordflow">      end if</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">! Assign the procedure pointers</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      wave_function =&gt; wave_function_2_electrons</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      reduced_hamiltonian =&gt; reduced_hamiltonian_2_electrons </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">! Set initialised flag, which is tested in the routines</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    initialised = .true.</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="basis__functions_8f90_source.html#l00045">b_length</a>, <a class="el" href="basis__functions_8f90_source.html#l00048">basis_type</a>, <a class="el" href="basis__functions_8f90_source.html#l00046">d_length</a>, <a class="el" href="basis__functions_8f90_source.html#l00052">dof_bounds</a>, <a class="el" href="basis__functions_8f90_source.html#l00044">fd_h</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00497">mno_allocate()</a>, <a class="el" href="basis__functions_8f90_source.html#l00041">n_atoms</a>, <a class="el" href="basis__functions_8f90_source.html#l00040">n_basis_functions_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00056">n_dofs_no_jastrow</a>, <a class="el" href="basis__functions_8f90_source.html#l00055">n_dofs_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00039">n_electrons</a>, <a class="el" href="basis__functions_8f90_source.html#l00043">n_jastrow_dofs</a>, <a class="el" href="basis__functions_8f90_source.html#l00051">n_space_dims</a>, <a class="el" href="basis__functions_8f90_source.html#l00050">number_dofs</a>, <a class="el" href="basis__functions_8f90_source.html#l00047">proton_numbers</a>, <a class="el" href="basis__functions_8f90_source.html#l00021">reduced_hamiltonian</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="constants_8f90_source.html#l00010">shared_constants::slater_1s_code</a>, <a class="el" href="constants_8f90_source.html#l00011">shared_constants::sto_3g_code</a>, <a class="el" href="basis__functions_8f90_source.html#l00020">wave_function</a>, <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00060">wave_function_single</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, <a class="el" href="Biased__Optim__example__driver_8f90_source.html#l00021">main()</a>, and <a class="el" href="ed__test_8f90_source.html#l00001">main_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_cgraph.png" border="0" usemap="#namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_cgraph" alt=""/></div>
<map name="namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_cgraph" id="namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_cgraph">
<area shape="rect" title="Initialisation routine." alt="" coords="5,195,192,236"/>
<area shape="rect" href="namespacebasis__functions.html#a0e84ba132fa13988d8882ae21a781832" title="Allocate parameters for Jastrow factor." alt="" coords="255,5,415,47"/>
<area shape="rect" href="namespacebasis__functions.html#acea41a868e0e1522cb6d3e3ed1b52d66" title="Reduced Hamiltonian for 2 electrons." alt="" coords="240,71,429,112"/>
<area shape="rect" href="namespacebasis__functions.html#a341dddb966f7d491ad3ffa90d862156f" title="Single Electron Reduced Hamiltonian: slater 1s basis." alt="" coords="243,136,426,177"/>
<area shape="rect" href="namespacebasis__functions.html#ac9aa926890ee9ca588ab8439095de68d" title="Single Electron wavefunction: slater 1s basis." alt="" coords="485,176,652,217"/>
<area shape="rect" href="namespacebasis__functions.html#a6dd883f5d1f574a78c3266f0ce627eb8" title="Single Electron Reduced Hamiltonian: gaussian sto3g basis." alt="" coords="243,253,426,295"/>
<area shape="rect" href="namespacebasis__functions.html#acdeef21beca62feb10d5f5057e30c342" title="Single Electron wavefunction: gaussian sto3g basis." alt="" coords="485,323,652,364"/>
<area shape="rect" href="namespacebasis__functions.html#a1f59f9576cb02ba4361bf7dc5046ce5d" title="Wavefunction for 2 electrons." alt="" coords="251,380,418,421"/>
<area shape="rect" href="namespacebasis__functions.html#a3aa2ed47c325e9955b40da5b344fd31a" title="Finite Difference Reduced Laplacian Computes finite difference approximation to the reduced laplacian..." alt="" coords="477,29,660,71"/>
<area shape="rect" href="namespacecomponent__functions.html#ae432b45b9b8516a44e035e4394e7d75c" title="Analytic Laplacian of Slater&#45;1s distribution centred at the origin." alt="" coords="487,95,650,151"/>
<area shape="rect" href="namespacecomponent__functions.html#a99c6a1b2ffe9693cccd857e51178c28e" title="Slater&#45;1s distribution centred at the origin." alt="" coords="716,140,879,181"/>
<area shape="rect" href="namespacecomponent__functions.html#a288bc484733f5e8d701360154c96b049" title="Analytic Laplacian of Gaussian distribution centred at the origin." alt="" coords="487,242,650,298"/>
<area shape="rect" href="namespacecomponent__functions.html#a2798b65288a55750171eb18624a5c663" title="Gaussian distribution centred at the origin." alt="" coords="716,285,879,327"/>
<area shape="rect" href="namespacecomponent__functions.html#a87166a18e7df3188b4ac3f123e39a3d7" title="Jastrow correlation fuction Function F from Schmidt and Moskowitz 1990." alt="" coords="487,388,650,429"/>
<area shape="rect" href="namespacecomponent__functions.html#ae19615a4b0c88888e2aa7a15cc51cd29" title="Jastrow subfuction: atom subterm Correlation term for each atom." alt="" coords="708,388,887,429"/>
<area shape="rect" href="namespacecomponent__functions.html#a97fe2b5cde42f4355466ef38099e014c" title="Functions that construct the Jastrow interaction function Notation here follows Schmidt and Moskowitz..." alt="" coords="935,355,1097,396"/>
<area shape="rect" href="namespacecomponent__functions.html#ae28c3bbfe7c6dbeb622126af558d8f84" title="Jastrow subfuction: basic subterm Subterm of the correlation function, one for each Jastrow dof per a..." alt="" coords="935,420,1097,461"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_icgraph.png" border="0" usemap="#namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_icgraph" id="namespacebasis__functions_a2b1743e80170bccff87171f1695bf9a3_icgraph">
<area shape="rect" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="ad155a8bce0b153e59bfef25f0d7e6e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad155a8bce0b153e59bfef25f0d7e6e1f">&#9670;&nbsp;</a></span>log_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::log_density </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Log of the Probability Density. </p>
<p>For the MCMC integration. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00540">540</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="keywordtype">    real</span>(dp) :: log_density</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    log_density = 2*log(abs(wave_function(position,dof_coefficients)))</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00020">wave_function</a>.</p>

<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, and <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_ad155a8bce0b153e59bfef25f0d7e6e1f_icgraph.png" border="0" usemap="#namespacebasis__functions_ad155a8bce0b153e59bfef25f0d7e6e1f_icgraph" alt=""/></div>
<map name="namespacebasis__functions_ad155a8bce0b153e59bfef25f0d7e6e1f_icgraph" id="namespacebasis__functions_ad155a8bce0b153e59bfef25f0d7e6e1f_icgraph">
<area shape="rect" title="Log of the Probability Density." alt="" coords="200,23,351,65"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="latin__driver_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title="Main driver for simulation using the latin_hypercube search." alt="" coords="29,56,129,83"/>
</map>
</div>

</div>
</div>
<a id="a0e84ba132fa13988d8882ae21a781832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e84ba132fa13988d8882ae21a781832">&#9670;&nbsp;</a></span>mno_allocate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine basis_functions::mno_allocate </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_terms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate parameters for Jastrow factor. </p>
<p>Allocates the paramters that determine type of Jastrow function. Sizes 0,3,7,9 supported. Functions are from Schmidt and Moskowitz 1990 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_terms</td><td>Number of terms in Jastrow correlation function </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00497">497</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">integer</span>,<span class="keywordtype">intent(in)</span> :: n_terms </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">select case</span> (n_terms)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">case</span> (0)</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        n_jastrow_dofs = 0</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">case</span> (3)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keyword">allocate</span>(mno_parameters(3,3))</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        mno_parameters(:,1) = [0,0,1]</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        mno_parameters(:,2) = [0,0,2]</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        mno_parameters(:,3) = [2,0,0]</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        n_jastrow_dofs = 3</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordflow">case</span> (7)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keyword">allocate</span>(mno_parameters(3,7))</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        mno_parameters(:,1) = [0,0,1]</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        mno_parameters(:,2) = [0,0,2]</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        mno_parameters(:,3) = [0,0,3]</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        mno_parameters(:,4) = [0,0,4]</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        mno_parameters(:,5) = [2,0,0]</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        mno_parameters(:,6) = [3,0,0]</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        mno_parameters(:,7) = [4,0,0]</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        n_jastrow_dofs = 7</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordflow">case</span> (9)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keyword">allocate</span>(mno_parameters(3,9))</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        mno_parameters(:,1) = [0,0,1]</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        mno_parameters(:,2) = [0,0,2]</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        mno_parameters(:,3) = [0,0,3]</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        mno_parameters(:,4) = [0,0,4]</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        mno_parameters(:,5) = [2,0,0]</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        mno_parameters(:,6) = [3,0,0]</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        mno_parameters(:,7) = [4,0,0]</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        mno_parameters(:,8) = [2,2,0]</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        mno_parameters(:,9) = [2,0,2]</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        n_jastrow_dofs = 9</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordflow">      case default</span> </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        print *, <span class="stringliteral">&quot;Jastrow term of size:&quot;</span>, n_terms, <span class="stringliteral">&quot;not supported&quot;</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        stop</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="keywordflow">    end select</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00057">mno_parameters</a>, and <a class="el" href="basis__functions_8f90_source.html#l00043">n_jastrow_dofs</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a0e84ba132fa13988d8882ae21a781832_icgraph.png" border="0" usemap="#namespacebasis__functions_a0e84ba132fa13988d8882ae21a781832_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a0e84ba132fa13988d8882ae21a781832_icgraph" id="namespacebasis__functions_a0e84ba132fa13988d8882ae21a781832_icgraph">
<area shape="rect" title="Allocate parameters for Jastrow factor." alt="" coords="435,49,595,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="acea41a868e0e1522cb6d3e3ed1b52d66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea41a868e0e1522cb6d3e3ed1b52d66">&#9670;&nbsp;</a></span>reduced_hamiltonian_2_electrons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::reduced_hamiltonian_2_electrons </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reduced Hamiltonian for 2 electrons. </p>
<p>Computes the reduced Hamiltonian $(H\psi)/\psi$ for 2 electrons. Uses discrete_Laplacian_reduced in this module. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00454">454</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordtype">    real</span>(dp) :: reduced_hamiltonian_2_electrons</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordtype">integer</span> :: j <span class="comment">! Loop variable</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      stop</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.n_space_dims) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted&quot;</span>, n_space_dims</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      stop</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dof_coefficients).ne.number_dofs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dof_coefficients), <span class="stringliteral">&quot;wanted&quot;</span>, number_dofs</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      stop</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">! Reduced Kinetic energy and electron-electron reduced potential energy</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">! $-0.5\nabla^2\psi$ +1/r, r distance between electrons</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    reduced_hamiltonian_2_electrons = -0.5_dp*discrete_laplacian_reduced(position, fd_h, dof_coefficients) &amp;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      + 1.0_dp /norm2(position(1:3)-position(4:6))</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">! Reduced electron-nuclear potential energy, -1/r, r distance from electron to atom</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">do</span> j = 1, n_atoms <span class="comment">! Loop over atoms</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      reduced_hamiltonian_2_electrons  = reduced_hamiltonian_2_electrons  &amp;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;          -proton_numbers(j) /norm2(position(1:3)-atom_coords(:,j))&amp;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          -proton_numbers(j) /norm2(position(4:6)-atom_coords(:,j))</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span> (n_atoms ==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      reduced_hamiltonian_2_electrons  = reduced_hamiltonian_2_electrons  &amp;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      +proton_numbers(1)*proton_numbers(2) /norm2(atom_coords(:,1)-atom_coords(:,2))</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="basis__functions_8f90_source.html#l00368">discrete_laplacian_reduced()</a>, <a class="el" href="basis__functions_8f90_source.html#l00044">fd_h</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00041">n_atoms</a>, <a class="el" href="basis__functions_8f90_source.html#l00051">n_space_dims</a>, <a class="el" href="basis__functions_8f90_source.html#l00050">number_dofs</a>, and <a class="el" href="basis__functions_8f90_source.html#l00047">proton_numbers</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_cgraph.png" border="0" usemap="#namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_cgraph" alt=""/></div>
<map name="namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_cgraph" id="namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_cgraph">
<area shape="rect" title="Reduced Hamiltonian for 2 electrons." alt="" coords="5,5,195,47"/>
<area shape="rect" href="namespacebasis__functions.html#a3aa2ed47c325e9955b40da5b344fd31a" title="Finite Difference Reduced Laplacian Computes finite difference approximation to the reduced laplacian..." alt="" coords="243,5,425,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_icgraph.png" border="0" usemap="#namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_icgraph" alt=""/></div>
<map name="namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_icgraph" id="namespacebasis__functions_acea41a868e0e1522cb6d3e3ed1b52d66_icgraph">
<area shape="rect" title="Reduced Hamiltonian for 2 electrons." alt="" coords="435,49,624,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="a341dddb966f7d491ad3ffa90d862156f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a341dddb966f7d491ad3ffa90d862156f">&#9670;&nbsp;</a></span>reduced_hamiltonian_slater_1s()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::reduced_hamiltonian_slater_1s </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single Electron Reduced Hamiltonian: slater 1s basis. </p>
<p>Reduced Hamiltonian $(H\psi)/\psi$ for 1 electron, with slater 1s type orbital Uses centered_slater_1s_laplacian in component_functions.f90 Used only for 1 electron problems. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>
<p>loop over atoms</p>
<p>loop over linear terms in wavefunction</p>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00315">315</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keywordtype">    real</span>(dp) :: reduced_hamiltonian_slater_1s</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">integer</span> :: i, j <span class="comment">! Loop variables</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      stop</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.n_space_dims) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted&quot;</span>, n_space_dims</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      stop</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dof_coefficients).ne.number_dofs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dof_coefficients), <span class="stringliteral">&quot;wanted&quot;</span>, number_dofs</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      stop</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    reduced_hamiltonian_slater_1s = 0.0_dp</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">! Kinetic energy term $-0.5\nabla^2\psi$</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">! This wavefunction is linear, and it is easy to compute this analytically</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">do</span> j = 0, n_atoms-1</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">do</span> i= 1,n_basis_functions_per_atom</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        reduced_hamiltonian_slater_1s = reduced_hamiltonian_slater_1s &amp;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          -0.5_dp * dof_coefficients( 2*i-1 +j*n_dofs_per_atom) &amp; <span class="comment">! linear coefficient dof</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            *centered_slater_1s_laplacian(position-atom_coords(:,j+1), &amp; <span class="comment">! position relative to atom</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;              dof_coefficients( 2*i +j*n_dofs_per_atom ) ) <span class="comment">! lengthscale dof</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">! Divide by the wavefunction to get reduced laplacian $(-0.5\nabla^2\psi)/\psi$</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    reduced_hamiltonian_slater_1s = reduced_hamiltonian_slater_1s/wave_function_slater_1s(position,dof_coefficients)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">! Potential energy, already reduced, so no wavefunction in this</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">do</span> j = 1, n_atoms <span class="comment">! loop over atoms</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    reduced_hamiltonian_slater_1s = reduced_hamiltonian_slater_1s &amp;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      -proton_numbers(j) /norm2(position-atom_coords(:,j)) <span class="comment">! -1/r, r distance from electron to atom</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span> (n_atoms ==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      reduced_hamiltonian_slater_1s = reduced_hamiltonian_slater_1s &amp;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      +proton_numbers(1)*proton_numbers(2) /norm2(atom_coords(:,1)-atom_coords(:,2))</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="component__functions_8f90_source.html#l00047">component_functions::centered_slater_1s_laplacian()</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00041">n_atoms</a>, <a class="el" href="basis__functions_8f90_source.html#l00040">n_basis_functions_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00055">n_dofs_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00051">n_space_dims</a>, <a class="el" href="basis__functions_8f90_source.html#l00050">number_dofs</a>, <a class="el" href="basis__functions_8f90_source.html#l00047">proton_numbers</a>, and <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_cgraph.png" border="0" usemap="#namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_cgraph" alt=""/></div>
<map name="namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_cgraph" id="namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_cgraph">
<area shape="rect" title="Single Electron Reduced Hamiltonian: slater 1s basis." alt="" coords="5,50,188,91"/>
<area shape="rect" href="namespacecomponent__functions.html#ae432b45b9b8516a44e035e4394e7d75c" title="Analytic Laplacian of Slater&#45;1s distribution centred at the origin." alt="" coords="238,5,401,61"/>
<area shape="rect" href="namespacebasis__functions.html#ac9aa926890ee9ca588ab8439095de68d" title="Single Electron wavefunction: slater 1s basis." alt="" coords="236,86,403,127"/>
<area shape="rect" href="namespacecomponent__functions.html#a99c6a1b2ffe9693cccd857e51178c28e" title="Slater&#45;1s distribution centred at the origin." alt="" coords="451,50,613,91"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_icgraph.png" border="0" usemap="#namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_icgraph" id="namespacebasis__functions_a341dddb966f7d491ad3ffa90d862156f_icgraph">
<area shape="rect" title="Single Electron Reduced Hamiltonian: slater 1s basis." alt="" coords="435,49,617,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="a6dd883f5d1f574a78c3266f0ce627eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dd883f5d1f574a78c3266f0ce627eb8">&#9670;&nbsp;</a></span>reduced_hamiltonian_sto3g()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::reduced_hamiltonian_sto3g </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single Electron Reduced Hamiltonian: gaussian sto3g basis. </p>
<p>Reduced Hamiltonian $(H\psi)/\psi$ for 1 electron, with basic gaussian sto3g type orbital Uses centered_gaussian_laplacian in component_functions.f90 Used only for 1 electron problems. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00594">594</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="keywordtype">    real</span>(dp) :: reduced_hamiltonian_sto3g</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">integer</span> :: i, j <span class="comment">! Loop variables</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      stop</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.n_space_dims) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted&quot;</span>, n_space_dims</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      stop</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dof_coefficients).ne.number_dofs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dof_coefficients), <span class="stringliteral">&quot;wanted&quot;</span>, number_dofs</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      stop</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    reduced_hamiltonian_sto3g = 0.0_dp</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">! Kinetic energy term $-0.5\nabla^2\psi$</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">! This wavefunction is linear, and it is easy to compute this analytically</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <span class="keywordflow">do</span> j = 0, n_atoms-1 <span class="comment">! loop over atoms</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="keywordflow">do</span> i= 1,n_basis_functions_per_atom <span class="comment">! loop over linear terms in wavefunction</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        reduced_hamiltonian_sto3g = reduced_hamiltonian_sto3g &amp;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;          -0.5_dp * dof_coefficients( 2*i-1 +j*n_dofs_per_atom) &amp; <span class="comment">! linear coefficient dof</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            *centered_gaussian_laplacian(position-atom_coords(:,j+1), &amp; <span class="comment">! position relative to atom</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;              dof_coefficients( 2*i +j*n_dofs_per_atom ) ) <span class="comment">! lengthscale dof</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="comment">! Divide by the wavefunction to get reduced laplacian $(-0.5\nabla^2\psi)/\psi$</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    reduced_hamiltonian_sto3g = reduced_hamiltonian_sto3g/wave_function_sto3g(position,dof_coefficients)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">! Potential energy, already reduced, so no wavefunction in this</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">do</span> j = 0, n_atoms-1 <span class="comment">! loop over atoms</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      reduced_hamiltonian_sto3g = reduced_hamiltonian_sto3g &amp;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      -1.0_dp /norm2(position-atom_coords(:,j+1)) <span class="comment">!-1/r, r distance from electron to atom</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (n_atoms ==2) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      reduced_hamiltonian_sto3g = reduced_hamiltonian_sto3g &amp;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      +proton_numbers(1)*proton_numbers(2) /norm2(atom_coords(:,1)-atom_coords(:,2))</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="component__functions_8f90_source.html#l00022">component_functions::centered_gaussian_laplacian()</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00041">n_atoms</a>, <a class="el" href="basis__functions_8f90_source.html#l00040">n_basis_functions_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00055">n_dofs_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00051">n_space_dims</a>, <a class="el" href="basis__functions_8f90_source.html#l00050">number_dofs</a>, <a class="el" href="basis__functions_8f90_source.html#l00047">proton_numbers</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_cgraph.png" border="0" usemap="#namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_cgraph" alt=""/></div>
<map name="namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_cgraph" id="namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_cgraph">
<area shape="rect" title="Single Electron Reduced Hamiltonian: gaussian sto3g basis." alt="" coords="5,50,188,91"/>
<area shape="rect" href="namespacecomponent__functions.html#a288bc484733f5e8d701360154c96b049" title="Analytic Laplacian of Gaussian distribution centred at the origin." alt="" coords="238,5,401,61"/>
<area shape="rect" href="namespacebasis__functions.html#acdeef21beca62feb10d5f5057e30c342" title="Single Electron wavefunction: gaussian sto3g basis." alt="" coords="236,86,403,127"/>
<area shape="rect" href="namespacecomponent__functions.html#a2798b65288a55750171eb18624a5c663" title="Gaussian distribution centred at the origin." alt="" coords="451,50,613,91"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_icgraph.png" border="0" usemap="#namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_icgraph" id="namespacebasis__functions_a6dd883f5d1f574a78c3266f0ce627eb8_icgraph">
<area shape="rect" title="Single Electron Reduced Hamiltonian: gaussian sto3g basis." alt="" coords="435,49,617,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="a1f59f9576cb02ba4361bf7dc5046ce5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f59f9576cb02ba4361bf7dc5046ce5d">&#9670;&nbsp;</a></span>wave_function_2_electrons()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::wave_function_2_electrons </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wavefunction for 2 electrons. </p>
<p>Uses subprocedure correlation_function in component_functions.f90 Uses the function pointer <a class="el" href="namespacebasis__functions.html#a0c617d7a4f11173571c4e29000df9a1a">wave_function_single</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00417">417</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="keywordtype">    real</span>(dp) :: wave_function_2_electrons</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      stop</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.n_space_dims) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted&quot;</span>, n_space_dims</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      stop</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dof_coefficients).ne.number_dofs) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dof_coefficients), <span class="stringliteral">&quot;wanted&quot;</span>, number_dofs</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      stop</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">! Slater determinant (trivial for 2 electron spin up/down pair)</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">! position(1:3) is coords of first electron, (4:6) is the second. dof(:n_no_jastrow) are the relevant dofs</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    wave_function_2_electrons = wave_function_single(position(1:3),dof_coefficients(:n_dofs_no_jastrow))&amp;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    * wave_function_single(position(4:6),dof_coefficients(:n_dofs_no_jastrow))</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">! Multiply by correlation function. This is the Jastrow term. dof(n_dofs_no_Jastrow+1:) are relevant terms</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (n_jastrow_dofs.ne.0) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    wave_function_2_electrons = &amp;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      correlation_function(atom_coords,position,mno_parameters,dof_coefficients(n_dofs_no_jastrow+1:),&amp;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      b_length,d_length)*wave_function_2_electrons</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="keywordflow">    end if</span></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="basis__functions_8f90_source.html#l00045">b_length</a>, <a class="el" href="component__functions_8f90_source.html#l00145">component_functions::correlation_function()</a>, <a class="el" href="basis__functions_8f90_source.html#l00046">d_length</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00057">mno_parameters</a>, <a class="el" href="basis__functions_8f90_source.html#l00056">n_dofs_no_jastrow</a>, <a class="el" href="basis__functions_8f90_source.html#l00043">n_jastrow_dofs</a>, <a class="el" href="basis__functions_8f90_source.html#l00051">n_space_dims</a>, <a class="el" href="basis__functions_8f90_source.html#l00050">number_dofs</a>, and <a class="el" href="basis__functions_8f90_source.html#l00060">wave_function_single</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_cgraph.png" border="0" usemap="#namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_cgraph" alt=""/></div>
<map name="namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_cgraph" id="namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_cgraph">
<area shape="rect" title="Wavefunction for 2 electrons." alt="" coords="5,39,172,80"/>
<area shape="rect" href="namespacecomponent__functions.html#a87166a18e7df3188b4ac3f123e39a3d7" title="Jastrow correlation fuction Function F from Schmidt and Moskowitz 1990." alt="" coords="220,39,383,80"/>
<area shape="rect" href="namespacecomponent__functions.html#ae19615a4b0c88888e2aa7a15cc51cd29" title="Jastrow subfuction: atom subterm Correlation term for each atom." alt="" coords="431,39,609,80"/>
<area shape="rect" href="namespacecomponent__functions.html#a97fe2b5cde42f4355466ef38099e014c" title="Functions that construct the Jastrow interaction function Notation here follows Schmidt and Moskowitz..." alt="" coords="657,5,820,47"/>
<area shape="rect" href="namespacecomponent__functions.html#ae28c3bbfe7c6dbeb622126af558d8f84" title="Jastrow subfuction: basic subterm Subterm of the correlation function, one for each Jastrow dof per a..." alt="" coords="657,71,820,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_icgraph.png" border="0" usemap="#namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_icgraph" alt=""/></div>
<map name="namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_icgraph" id="namespacebasis__functions_a1f59f9576cb02ba4361bf7dc5046ce5d_icgraph">
<area shape="rect" title="Wavefunction for 2 electrons." alt="" coords="435,49,601,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="ac9aa926890ee9ca588ab8439095de68d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9aa926890ee9ca588ab8439095de68d">&#9670;&nbsp;</a></span>wave_function_slater_1s()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::wave_function_slater_1s </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single Electron wavefunction: slater 1s basis. </p>
<p>Uses centered_slater_1s in component_functions.f90 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electron </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00276">276</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keywordtype">    real</span>(dp) :: wave_function_slater_1s</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">integer</span> :: i, j <span class="comment">! loop variables</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      stop</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted 3&quot;</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      stop</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dof_coefficients).ne.n_dofs_no_jastrow) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dof_coefficients), <span class="stringliteral">&quot;wanted&quot;</span>, n_dofs_no_jastrow</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      stop</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">! Wavefunction is sum over linear terms with 2 dofs each - a linear coefficient and a lengthscale</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    wave_function_slater_1s = 0.0_dp </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">do</span> j = 0, n_atoms-1 <span class="comment">! loop over atoms</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">do</span> i= 1, n_basis_functions_per_atom <span class="comment">! loop over linear terms in wavefunction</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        wave_function_slater_1s = wave_function_slater_1s + &amp;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          dof_coefficients( 2*i-1 + j*n_dofs_per_atom )&amp; <span class="comment">! linear coefficient dof</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            *centered_slater_1s(position-atom_coords(:,j+1), &amp; <span class="comment">! position relative to atom</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;              dof_coefficients( 2*i + j*n_dofs_per_atom  ) ) <span class="comment">! lengthscale dof</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="component__functions_8f90_source.html#l00035">component_functions::centered_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00041">n_atoms</a>, <a class="el" href="basis__functions_8f90_source.html#l00040">n_basis_functions_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00056">n_dofs_no_jastrow</a>, and <a class="el" href="basis__functions_8f90_source.html#l00055">n_dofs_per_atom</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_cgraph.png" border="0" usemap="#namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_cgraph" alt=""/></div>
<map name="namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_cgraph" id="namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_cgraph">
<area shape="rect" title="Single Electron wavefunction: slater 1s basis." alt="" coords="5,5,172,47"/>
<area shape="rect" href="namespacecomponent__functions.html#a99c6a1b2ffe9693cccd857e51178c28e" title="Slater&#45;1s distribution centred at the origin." alt="" coords="220,5,383,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_icgraph.png" border="0" usemap="#namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_icgraph" alt=""/></div>
<map name="namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_icgraph" id="namespacebasis__functions_ac9aa926890ee9ca588ab8439095de68d_icgraph">
<area shape="rect" title="Single Electron wavefunction: slater 1s basis." alt="" coords="665,49,832,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="namespacebasis__functions.html#a341dddb966f7d491ad3ffa90d862156f" title="Single Electron Reduced Hamiltonian: slater 1s basis." alt="" coords="435,78,617,119"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<a id="acdeef21beca62feb10d5f5057e30c342"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdeef21beca62feb10d5f5057e30c342">&#9670;&nbsp;</a></span>wave_function_sto3g()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function basis_functions::wave_function_sto3g </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>position</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Single Electron wavefunction: gaussian sto3g basis. </p>
<p>Uses centered_gaussian in component_functions.f90 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">position</td><td>Space coordinate of electron </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dof_coefficients</td><td>Values of the dofs </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00554">554</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keywordtype">    real</span>(dp) :: wave_function_sto3g</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: position </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="keywordtype">    real</span>(dp), <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">intent(in)</span> :: dof_coefficients </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordtype">integer</span> :: i, j <span class="comment">! loop variables</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">! Initialise and bounds tests</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordflow">if</span> (.not.(initialised)) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      print *, <span class="stringliteral">&quot;Error, basis not initialised&quot;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      stop</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(position).ne.3) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong space dimension, got&quot;</span>, <span class="keyword">size</span>(position), <span class="stringliteral">&quot;wanted 3&quot;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      stop</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">size</span>(dof_coefficients).ne.n_dofs_no_jastrow) <span class="keywordflow">then</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      print *, <span class="stringliteral">&quot;Error, wrong number of dofs, got&quot;</span>, <span class="keyword">size</span>(dof_coefficients), <span class="stringliteral">&quot;wanted&quot;</span>, n_dofs_no_jastrow</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      stop</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordflow">    end if</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">! Wavefunction is sum over linear terms with 2 dofs each - a linear coefficient and a lengthscale</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    wave_function_sto3g = 0.0_dp </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">do</span> j = 0, n_atoms-1 <span class="comment">! loop over atoms</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">do</span> i= 1, n_basis_functions_per_atom <span class="comment">! loop over linear terms in wavefunction</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        wave_function_sto3g = wave_function_sto3g + &amp;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          dof_coefficients( 2*i-1 + j*n_dofs_per_atom )&amp; <span class="comment">! linear coefficient dof</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            *centered_gaussian(position-atom_coords(:,j+1), &amp; <span class="comment">! position relative to atom</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;              dof_coefficients( 2*i + j*n_dofs_per_atom  ) ) <span class="comment">! lengthscale dof</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordflow">      end do</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="keywordflow">    end do</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="basis__functions_8f90_source.html#l00042">atom_coords</a>, <a class="el" href="component__functions_8f90_source.html#l00011">component_functions::centered_gaussian()</a>, <a class="el" href="basis__functions_8f90_source.html#l00036">initialised</a>, <a class="el" href="basis__functions_8f90_source.html#l00041">n_atoms</a>, <a class="el" href="basis__functions_8f90_source.html#l00040">n_basis_functions_per_atom</a>, <a class="el" href="basis__functions_8f90_source.html#l00056">n_dofs_no_jastrow</a>, and <a class="el" href="basis__functions_8f90_source.html#l00055">n_dofs_per_atom</a>.</p>

<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_cgraph.png" border="0" usemap="#namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_cgraph" alt=""/></div>
<map name="namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_cgraph" id="namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_cgraph">
<area shape="rect" title="Single Electron wavefunction: gaussian sto3g basis." alt="" coords="5,5,172,47"/>
<area shape="rect" href="namespacecomponent__functions.html#a2798b65288a55750171eb18624a5c663" title="Gaussian distribution centred at the origin." alt="" coords="220,5,383,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_icgraph.png" border="0" usemap="#namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_icgraph" alt=""/></div>
<map name="namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_icgraph" id="namespacebasis__functions_acdeef21beca62feb10d5f5057e30c342_icgraph">
<area shape="rect" title="Single Electron wavefunction: gaussian sto3g basis." alt="" coords="665,49,832,90"/>
<area shape="rect" href="namespacebasis__functions.html#a2b1743e80170bccff87171f1695bf9a3" title="Initialisation routine." alt="" coords="200,49,387,90"/>
<area shape="rect" href="namespacebasis__functions.html#a6dd883f5d1f574a78c3266f0ce627eb8" title="Single Electron Reduced Hamiltonian: gaussian sto3g basis." alt="" coords="435,78,617,119"/>
<area shape="rect" href="bond__driver_8f90.html#ad11c5dff0e05a402b470d0c824badbbc" title="Driver for running multiple simulations to optimise bondlength." alt="" coords="5,5,152,32"/>
<area shape="rect" href="Biased__Optim__example__driver_8f90.html#a8ec2266d83cd6c0b762cbcbc92c0af3d" title=" " alt="" coords="51,56,106,83"/>
<area shape="rect" href="ed__test_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title=" " alt="" coords="29,107,129,133"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae2433e6f0971d508142a511c8d87c30b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2433e6f0971d508142a511c8d87c30b">&#9670;&nbsp;</a></span>atom_coords</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable, protected basis_functions::atom_coords</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00042">42</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keywordtype">  real</span>(dp), <span class="keywordtype">protected</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: atom_coords <span class="comment">! Coordinates of the atoms. Shape (3,n_atoms)</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00267">deinitialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

</div>
</div>
<a id="a981aa8fc3a64198138bccb0413dacc94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a981aa8fc3a64198138bccb0413dacc94">&#9670;&nbsp;</a></span>b_length</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), protected basis_functions::b_length</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00045">45</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keywordtype">  real</span>(dp), <span class="keywordtype">protected</span> :: b_length <span class="comment">! Inverse lengthscale of nuclear-electron interaction</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>.</p>

</div>
</div>
<a id="a9c148eb124b16f4ce8a5c822b7ef30f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c148eb124b16f4ce8a5c822b7ef30f4">&#9670;&nbsp;</a></span>basis_type</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::basis_type</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00048">48</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: basis_type <span class="comment">! integer code for type of basis. In shared_constants module</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>

</div>
</div>
<a id="a0f3a451d100c71d40dcfced3b16334e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f3a451d100c71d40dcfced3b16334e4">&#9670;&nbsp;</a></span>d_length</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), protected basis_functions::d_length</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00046">46</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keywordtype">  real</span>(dp), <span class="keywordtype">protected</span> :: d_length <span class="comment">! Inverse lengthscale of electron-electron interaction</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>.</p>

</div>
</div>
<a id="ad4fc66a8a927069f6788785e3ade0ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4fc66a8a927069f6788785e3ade0ff3">&#9670;&nbsp;</a></span>dof_bounds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable, protected basis_functions::dof_bounds</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00052">52</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">  real</span>(dp), <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">protected</span> :: dof_bounds <span class="comment">! Default bounds for the possible dof values</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, <a class="el" href="basis__functions_8f90_source.html#l00267">deinitialise_basis()</a>, <a class="el" href="stoch__grad_8f90_source.html#l00058">stoch_grad::grad_accent()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="Biased__Optim__example__driver_8f90_source.html#l00021">main()</a>, <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>, and <a class="el" href="stoch__grad_8f90_source.html#l00023">stoch_grad::stoch_grad_init()</a>.</p>

</div>
</div>
<a id="ac8114bf21770f69fbbc228d14a9c2bf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8114bf21770f69fbbc228d14a9c2bf4">&#9670;&nbsp;</a></span>fd_h</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), protected basis_functions::fd_h</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00044">44</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keywordtype">  real</span>(dp), <span class="keywordtype">protected</span> :: fd_h <span class="comment">! Lengthscale of the finite difference code</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>.</p>

</div>
</div>
<a id="a33299211b5f4167aa20494965e6df6fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33299211b5f4167aa20494965e6df6fe">&#9670;&nbsp;</a></span>initialised</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, protected basis_functions::initialised = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00036">36</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">logical</span>, <span class="keywordtype">protected</span> :: initialised = .false. <span class="comment">! Flag set by initialisation routine, checked by other routines</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00267">deinitialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00368">discrete_laplacian_reduced()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

</div>
</div>
<a id="a6153b94101ca52c60301c014e8018cd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6153b94101ca52c60301c014e8018cd3">&#9670;&nbsp;</a></span>mno_parameters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, dimension(:,:), allocatable, protected basis_functions::mno_parameters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00057">57</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">dimension(:,:)</span> :: mno_parameters <span class="comment">! Parameters that specify the particular choice of Jastrow term</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00267">deinitialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00497">mno_allocate()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>.</p>

</div>
</div>
<a id="a7a106093181d8f73b5757e18bed45354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a106093181d8f73b5757e18bed45354">&#9670;&nbsp;</a></span>n_atoms</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_atoms</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00041">41</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_atoms <span class="comment">! Number of atoms</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

</div>
</div>
<a id="ac9fb7e7b9af3e057ec02a2feb7368b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9fb7e7b9af3e057ec02a2feb7368b8e">&#9670;&nbsp;</a></span>n_basis_functions_per_atom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_basis_functions_per_atom</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00040">40</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_basis_functions_per_atom <span class="comment">! Number of linear terms in the single-electron wavefunction per atom</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

</div>
</div>
<a id="a931089e272b9708ea78e4e84774e6491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a931089e272b9708ea78e4e84774e6491">&#9670;&nbsp;</a></span>n_dofs_no_jastrow</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_dofs_no_jastrow</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00056">56</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_dofs_no_Jastrow <span class="comment">! Number of dofs without Jastrow term, for convenience</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

</div>
</div>
<a id="a3fc655d1e5dbccbd5fa2598c80dcb673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fc655d1e5dbccbd5fa2598c80dcb673">&#9670;&nbsp;</a></span>n_dofs_per_atom</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_dofs_per_atom</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00055">55</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_dofs_per_atom <span class="comment">! Number of dofs per atom, for convenience</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="basis__functions_8f90_source.html#l00276">wave_function_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00554">wave_function_sto3g()</a>.</p>

</div>
</div>
<a id="ad4dfb3b99da7a98dfb63e70865a1ee29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4dfb3b99da7a98dfb63e70865a1ee29">&#9670;&nbsp;</a></span>n_electrons</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_electrons</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00039">39</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_electrons <span class="comment">! Number of electrons</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>.</p>

</div>
</div>
<a id="ac8eaad13ee1fa3799c55ff4fe1dc48b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8eaad13ee1fa3799c55ff4fe1dc48b5">&#9670;&nbsp;</a></span>n_jastrow_dofs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_jastrow_dofs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00043">43</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_Jastrow_dofs <span class="comment">! Number of dofs in the Jastrow (interaction) term</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00497">mno_allocate()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>.</p>

</div>
</div>
<a id="aa2e0cf4f62dc5afc6f91a283ba3f055e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2e0cf4f62dc5afc6f91a283ba3f055e">&#9670;&nbsp;</a></span>n_space_dims</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::n_space_dims</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00051">51</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: n_space_dims <span class="comment">! Number of space dimensions, 3*n_electrons, for convenience</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, <a class="el" href="basis__functions_8f90_source.html#l00368">discrete_laplacian_reduced()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>, and <a class="el" href="electron__density_8f90_source.html#l00063">electron_density_functions::wave_function_normalisation()</a>.</p>

</div>
</div>
<a id="a79b525380de9887a3919e23b5fd03e75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79b525380de9887a3919e23b5fd03e75">&#9670;&nbsp;</a></span>number_dofs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, protected basis_functions::number_dofs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00050">50</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">integer</span>, <span class="keywordtype">protected</span> :: number_dofs <span class="comment">! Total number of degrees of freedom (dofs) in the wavefunction</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, <a class="el" href="basis__functions_8f90_source.html#l00368">discrete_laplacian_reduced()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="Biased__Optim__example__driver_8f90_source.html#l00021">main()</a>, <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>.</p>

</div>
</div>
<a id="a7936f84f27dc052e58eb470bc220fb85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7936f84f27dc052e58eb470bc220fb85">&#9670;&nbsp;</a></span>proton_numbers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), allocatable, protected basis_functions::proton_numbers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00047">47</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="keywordtype">  real</span>(dp),<span class="keywordtype">dimension(:)</span>,<span class="keywordtype">allocatable</span>, <span class="keywordtype">protected</span> :: proton_numbers <span class="comment">! Proton Numbers of atoms</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00267">deinitialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00454">reduced_hamiltonian_2_electrons()</a>, <a class="el" href="basis__functions_8f90_source.html#l00315">reduced_hamiltonian_slater_1s()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00594">reduced_hamiltonian_sto3g()</a>.</p>

</div>
</div>
<a id="ab9981898fc0fed9c10945781e26917b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9981898fc0fed9c10945781e26917b1">&#9670;&nbsp;</a></span>reduced_hamiltonian</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure(<a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a>), pointer basis_functions::reduced_hamiltonian</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00021">21</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">procedure</span>(wave_function_interface), <span class="keywordtype">pointer</span> :: reduced_hamiltonian</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="bond__driver_8f90_source.html#l00007">bond_length_driver()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="Biased__Optim__example__driver_8f90_source.html#l00021">main()</a>, and <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>.</p>

</div>
</div>
<a id="a5176e9e5598bd13047a4c720fbc37c50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5176e9e5598bd13047a4c720fbc37c50">&#9670;&nbsp;</a></span>wave_function</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure(<a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a>), pointer basis_functions::wave_function</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00020">20</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  <span class="keywordtype">procedure</span>(wave_function_interface), <span class="keywordtype">pointer</span> :: wave_function</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="calc_8f90_source.html#l00018">calculations::calc()</a>, <a class="el" href="basis__functions_8f90_source.html#l00368">discrete_laplacian_reduced()</a>, <a class="el" href="electron__density_8f90_source.html#l00011">electron_density_functions::electron_density()</a>, <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, <a class="el" href="basis__functions_8f90_source.html#l00540">log_density()</a>, <a class="el" href="Biased__Optim__example__driver_8f90_source.html#l00009">log_rho_mod::log_rho()</a>, and <a class="el" href="electron__density_8f90_source.html#l00063">electron_density_functions::wave_function_normalisation()</a>.</p>

</div>
</div>
<a id="a0c617d7a4f11173571c4e29000df9a1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c617d7a4f11173571c4e29000df9a1a">&#9670;&nbsp;</a></span>wave_function_single</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">procedure(<a class="el" href="interfacebasis__functions_1_1wave__function__interface.html">wave_function_interface</a>), pointer basis_functions::wave_function_single</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="basis__functions_8f90_source.html#l00060">60</a> of file <a class="el" href="basis__functions_8f90_source.html">basis_functions.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">procedure</span>(wave_function_interface), <span class="keywordtype">pointer</span> :: wave_function_single</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="basis__functions_8f90_source.html#l00069">initialise_basis()</a>, and <a class="el" href="basis__functions_8f90_source.html#l00417">wave_function_2_electrons()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacebasis__functions.html">basis_functions</a></li>
    <li class="footer">Generated on Wed May 26 2021 17:57:40 for PX 915 Project Title/Name Here by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
