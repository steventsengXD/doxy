<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PX 915: Variational Quantum Monte Carlo - LATIN: write_file Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-MML-AM_CHTML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PX 915: Variational Quantum Monte Carlo - LATIN
   &#160;<span id="projectnumber">GroupB</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacewrite__file.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">write_file Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains all the subroutines related to writing results to file.  
<a href="namespacewrite__file.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3456d4f27de6570b87711fb5cd6fef76"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewrite__file.html#a3456d4f27de6570b87711fb5cd6fef76">result_netcdf</a> (dof, ele, num_ele, num_nuc)</td></tr>
<tr class="memdesc:a3456d4f27de6570b87711fb5cd6fef76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main results writing to NetCDF file.  <a href="namespacewrite__file.html#a3456d4f27de6570b87711fb5cd6fef76">More...</a><br /></td></tr>
<tr class="separator:a3456d4f27de6570b87711fb5cd6fef76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7309e6004e1ea127b9ab60d14f197ed8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewrite__file.html#a7309e6004e1ea127b9ab60d14f197ed8">energies_netcdf</a> (energies, bondlen)</td></tr>
<tr class="memdesc:a7309e6004e1ea127b9ab60d14f197ed8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output results for bond lengths and corresponding energy used for plotting.  <a href="namespacewrite__file.html#a7309e6004e1ea127b9ab60d14f197ed8">More...</a><br /></td></tr>
<tr class="separator:a7309e6004e1ea127b9ab60d14f197ed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a988eccddc1dfeda968686c7155ce133a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewrite__file.html#a988eccddc1dfeda968686c7155ce133a">xy_grid</a> (points, box_size)</td></tr>
<tr class="memdesc:a988eccddc1dfeda968686c7155ce133a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes the xyz coordinates used in the calculation of either the wavefunction or electron density to a text file names xyz.txt.  <a href="namespacewrite__file.html#a988eccddc1dfeda968686c7155ce133a">More...</a><br /></td></tr>
<tr class="separator:a988eccddc1dfeda968686c7155ce133a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85af283f6b75ebd924045dbb95bf169a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewrite__file.html#a85af283f6b75ebd924045dbb95bf169a">write_restart_file</a> (gp_n_data, gp_n_dof, n_cycles, no_samples, current_best_E, constant_mean_value, gamma, kernel_var, kernal_inv_length, E_data, data_mean, param_pres, param_cov, param_data)</td></tr>
<tr class="memdesc:a85af283f6b75ebd924045dbb95bf169a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a NetCDF file which contains information needed for the restart of the Bi_Op_step function.  <a href="namespacewrite__file.html#a85af283f6b75ebd924045dbb95bf169a">More...</a><br /></td></tr>
<tr class="separator:a85af283f6b75ebd924045dbb95bf169a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bee3284ae2e7b54b1a499095dfee1ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewrite__file.html#a7bee3284ae2e7b54b1a499095dfee1ee">handle_err</a> (ierr)</td></tr>
<tr class="memdesc:a7bee3284ae2e7b54b1a499095dfee1ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the NetCDF errors and print statements.  <a href="namespacewrite__file.html#a7bee3284ae2e7b54b1a499095dfee1ee">More...</a><br /></td></tr>
<tr class="separator:a7bee3284ae2e7b54b1a499095dfee1ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains all the subroutines related to writing results to file. </p>
<p>This module contains all the subroutines needed for all the output result files which will be used for plotting and restarting. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7309e6004e1ea127b9ab60d14f197ed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7309e6004e1ea127b9ab60d14f197ed8">&#9670;&nbsp;</a></span>energies_netcdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine write_file::energies_netcdf </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>energies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>bondlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output results for bond lengths and corresponding energy used for plotting. </p>
<p>Will only be used for the 2 nuclei case. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">filename</td><td>outputs a NetCDF file named bond_length.nc4</td></tr>
  </table>
  </dd>
</dl>
<p>Dimension names</p>
<p>ID's</p>
<p>Inputting the data</p>
<p>Writing data to file</p>
<p>Closing the file</p>

<p class="definition">Definition at line <a class="el" href="netcdf__file_8f90_source.html#l00115">115</a> of file <a class="el" href="netcdf__file_8f90_source.html">netcdf_file.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: dp=kind(1.0d0)</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">! Inputting variables</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span> :: filename = <span class="stringliteral">&#39;bond_length.nc4&#39;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: energies, bondlen</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(1)</span> :: dim_e = (/<span class="stringliteral">&quot;Energy&quot;</span>/)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(1)</span> :: dim_b = (/<span class="stringliteral">&quot;Bond_Lengths&quot;</span>/)</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">! File IDs</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">INTEGER</span> :: ierr, file_id</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">! Variable ID&#39;s</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_e, var_b</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">! Dimension ID&#39;s for the arrays</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(1)</span> :: did_e, did_b</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">! Implicit types for the array sizes</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(1)</span> :: size_e, size_b</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">! Create the file</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    ierr = nf90_create(filename, nf90_clobber, file_id)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">! Variable sizes</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    size_e = shape(energies)</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    size_b = shape(bondlen)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">! Energies</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    ierr = nf90_def_dim(file_id, dim_e(1), size_e(1), did_e(1))</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;Energy&quot;</span>, nf90_double, did_e, var_e)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">! Bond length</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    ierr = nf90_def_dim(file_id, dim_b(1), size_b(1), did_b(1))</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;Bond_length&quot;</span>, nf90_double, did_b, var_b)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">! Metadata</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    ierr = nf90_enddef(file_id)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">! Energy</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    ierr = nf90_put_var(file_id, var_e, energies)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    ierr = nf90_put_var(file_id, var_b, bondlen)</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    ierr = nf90_close(file_id)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">!Finishing statement if writing file is successful.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    print *, <span class="stringliteral">&quot;Success in writing the NETCDF file: &quot;</span>, filename</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="netcdf__file_8f90_source.html#l00436">handle_err()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewrite__file_a7309e6004e1ea127b9ab60d14f197ed8_cgraph.png" border="0" usemap="#namespacewrite__file_a7309e6004e1ea127b9ab60d14f197ed8_cgraph" alt=""/></div>
<map name="namespacewrite__file_a7309e6004e1ea127b9ab60d14f197ed8_cgraph" id="namespacewrite__file_a7309e6004e1ea127b9ab60d14f197ed8_cgraph">
<area shape="rect" title="Output results for bond lengths and corresponding energy used for plotting." alt="" coords="5,5,152,47"/>
<area shape="rect" href="namespacewrite__file.html#a7bee3284ae2e7b54b1a499095dfee1ee" title="Handles the NetCDF errors and print statements." alt="" coords="200,13,360,39"/>
</map>
</div>

</div>
</div>
<a id="a7bee3284ae2e7b54b1a499095dfee1ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bee3284ae2e7b54b1a499095dfee1ee">&#9670;&nbsp;</a></span>handle_err()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine write_file::handle_err </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ierr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles the NetCDF errors and print statements. </p>
<p>This subroutine is only used and called within this module. </p>

<p class="definition">Definition at line <a class="el" href="netcdf__file_8f90_source.html#l00436">436</a> of file <a class="el" href="netcdf__file_8f90_source.html">netcdf_file.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: ierr</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keywordflow">THEN</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      print *, trim(nf90_strerror(ierr))</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="comment">! Stops the code if an error is found</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      stop <span class="stringliteral">&quot;Stopped&quot;</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordflow">    END IF</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="netcdf__file_8f90_source.html#l00115">energies_netcdf()</a>, <a class="el" href="netcdf__file_8f90_source.html#l00019">result_netcdf()</a>, and <a class="el" href="netcdf__file_8f90_source.html#l00224">write_restart_file()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewrite__file_a7bee3284ae2e7b54b1a499095dfee1ee_icgraph.png" border="0" usemap="#namespacewrite__file_a7bee3284ae2e7b54b1a499095dfee1ee_icgraph" alt=""/></div>
<map name="namespacewrite__file_a7bee3284ae2e7b54b1a499095dfee1ee_icgraph" id="namespacewrite__file_a7bee3284ae2e7b54b1a499095dfee1ee_icgraph">
<area shape="rect" title="Handles the NetCDF errors and print statements." alt="" coords="404,78,564,105"/>
<area shape="rect" href="namespacewrite__file.html#a7309e6004e1ea127b9ab60d14f197ed8" title="Output results for bond lengths and corresponding energy used for plotting." alt="" coords="181,5,328,47"/>
<area shape="rect" href="namespacewrite__file.html#a3456d4f27de6570b87711fb5cd6fef76" title="Main results writing to NetCDF file." alt="" coords="191,71,319,112"/>
<area shape="rect" href="namespacewrite__file.html#a85af283f6b75ebd924045dbb95bf169a" title="Creates a NetCDF file which contains information needed for the restart of the Bi_Op_step function." alt="" coords="153,137,356,163"/>
<area shape="rect" href="latin__driver_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title="Main driver for simulation using the latin_hypercube search." alt="" coords="5,78,105,105"/>
</map>
</div>

</div>
</div>
<a id="a3456d4f27de6570b87711fb5cd6fef76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3456d4f27de6570b87711fb5cd6fef76">&#9670;&nbsp;</a></span>result_netcdf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine write_file::result_netcdf </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>num_nuc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main results writing to NetCDF file. </p>
<p>The result_netcdf subroutine outputs the main NetCDF result file containing the optimal degrees of freedom, either the electron density or wavefunction and the number of electrons and nuclei used. Saves the file as results.nc4 which is used Has error statements printed out at each section in order to aid with debugging. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dof</td><td>dof the optimal degrees of freedom </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ele</td><td>ele an rank 1 array containing either the wavefunction or electron density results evaluated on a grid op coordinates (for 1 or 2 electron system respectively). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_ele</td><td>num_ele the number of electrons used in the calculation </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">num_nuc</td><td>the number of nuclei used in the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_nuc</td><td>num_ele the number of electrons used in the calculation </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">num_nuc</td><td>the number of nuclei used in the calculation </td></tr>
  </table>
  </dd>
</dl>
<p>Dimension names for the arrays.</p>
<p>ID's</p>
<p>Inputting the data</p>
<p>Writing the data to file</p>
<p>Closing the file</p>

<p class="definition">Definition at line <a class="el" href="netcdf__file_8f90_source.html#l00019">19</a> of file <a class="el" href="netcdf__file_8f90_source.html">netcdf_file.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: dp=kind(1.0d0)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span> :: filename = <span class="stringliteral">&#39;results.nc4&#39;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: dof</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: ele</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: num_ele, num_nuc</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(1)</span> :: dim_dof = (/<span class="stringliteral">&quot;Optimal_DOF&quot;</span>/)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(1)</span> :: dim_ele = (/<span class="stringliteral">&quot;Electron_Density&quot;</span>/)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">! File ID&#39;s</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">INTEGER</span> :: ierr, file_id</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">! Variable ID&#39;s</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_dof,  var_ele, var_num_ele, var_num_nuc</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">! Dimension ID&#39;s for the arrays</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(1)</span> :: did_dof, did_ele</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">! Implicit types for the sizes for the arrays</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(1)</span> :: size_dof, size_ele</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">! Create the file</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    ierr = nf90_create(filename, nf90_clobber, file_id)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">! Variable sizes</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    size_dof = shape(dof)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    size_ele = shape(ele)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">! Number of electrons</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;Num_of_Electrons&quot;</span>, nf90_double, var_num_ele)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">! Number of nuclei</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;Num_of_Nuclei&quot;</span>, nf90_double, var_num_nuc)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">! DOF</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    ierr = nf90_def_dim(file_id, dim_dof(1), size_dof(1), did_dof(1))</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;Optimal_DOF&quot;</span>, nf90_double, did_dof, var_dof)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">! Electron Density</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    ierr = nf90_def_dim(file_id, dim_ele(1), size_ele(1), did_ele(1))</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;Electron_Density&quot;</span>, nf90_double, did_ele, var_ele)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">! Metadata</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    ierr = nf90_enddef(file_id)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">! Number of electrons</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    ierr = nf90_put_var(file_id, var_num_ele, num_ele)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">! Number of nuclei</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    ierr = nf90_put_var(file_id, var_num_nuc, num_nuc)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">! DOF</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    ierr = nf90_put_var(file_id, var_dof, dof)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">! Electron Density</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    ierr = nf90_put_var(file_id, var_ele, ele)</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    ierr = nf90_close(file_id)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">!Finishing statement if writing file is successful.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    print *, <span class="stringliteral">&quot;Success in writing the NETCDF file: &quot;</span>, filename</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="netcdf__file_8f90_source.html#l00436">handle_err()</a>.</p>

<p class="reference">Referenced by <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_cgraph.png" border="0" usemap="#namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_cgraph" alt=""/></div>
<map name="namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_cgraph" id="namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_cgraph">
<area shape="rect" title="Main results writing to NetCDF file." alt="" coords="5,5,133,47"/>
<area shape="rect" href="namespacewrite__file.html#a7bee3284ae2e7b54b1a499095dfee1ee" title="Handles the NetCDF errors and print statements." alt="" coords="181,13,341,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_icgraph.png" border="0" usemap="#namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_icgraph" alt=""/></div>
<map name="namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_icgraph" id="namespacewrite__file_a3456d4f27de6570b87711fb5cd6fef76_icgraph">
<area shape="rect" title="Main results writing to NetCDF file." alt="" coords="153,5,281,47"/>
<area shape="rect" href="latin__driver_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title="Main driver for simulation using the latin_hypercube search." alt="" coords="5,13,105,39"/>
</map>
</div>

</div>
</div>
<a id="a85af283f6b75ebd924045dbb95bf169a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85af283f6b75ebd924045dbb95bf169a">&#9670;&nbsp;</a></span>write_restart_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine write_file::write_restart_file </td>
          <td>(</td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>gp_n_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>gp_n_dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>n_cycles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>no_samples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>current_best_E</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>constant_mean_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>kernel_var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp)&#160;</td>
          <td class="paramname"><em>kernal_inv_length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>E_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>data_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>param_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>param_cov</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>param_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a NetCDF file which contains information needed for the restart of the Bi_Op_step function. </p>
<p>This file will be created in the event that the Bi_Op_step function crashes. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">gp_n_data</td><td>Defining everything for the scalar variables </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_data</td><td>is the data used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_dof</td><td>is the degrees of freedom used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_cycles</td><td>is the number of cycles </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">no_samples</td><td>is the number of samples </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_best_E</td><td>is the current best energy found so far during the run. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">constant_mean_value</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gamma</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernel_var</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernal_inv_length</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_dof</td><td>Defining everything for the scalar variables </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_data</td><td>is the data used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_dof</td><td>is the degrees of freedom used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_cycles</td><td>is the number of cycles </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">no_samples</td><td>is the number of samples </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_best_E</td><td>is the current best energy found so far during the run. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">constant_mean_value</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gamma</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernel_var</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernal_inv_length</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_cycles</td><td>Defining everything for the scalar variables </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_data</td><td>is the data used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_dof</td><td>is the degrees of freedom used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_cycles</td><td>is the number of cycles </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">no_samples</td><td>is the number of samples </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_best_E</td><td>is the current best energy found so far during the run. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">constant_mean_value</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gamma</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernel_var</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernal_inv_length</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">no_samples</td><td>Defining everything for the scalar variables </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_data</td><td>is the data used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_dof</td><td>is the degrees of freedom used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_cycles</td><td>is the number of cycles </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">no_samples</td><td>is the number of samples </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_best_E</td><td>is the current best energy found so far during the run. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">constant_mean_value</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gamma</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernel_var</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernal_inv_length</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_best_e</td><td>Defining everything for the scalar variables </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_data</td><td>is the data used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gp_n_dof</td><td>is the degrees of freedom used for the GP surrogate </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">n_cycles</td><td>is the number of cycles </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">no_samples</td><td>is the number of samples </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">current_best_E</td><td>is the current best energy found so far during the run. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">constant_mean_value</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">gamma</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernel_var</td><td></td></tr>
    <tr><td class="paramdir"></td><td class="paramname">kernal_inv_length</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">e_data</td><td>Defining everything for the array variables Rank 1 arrays </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">E_data</td><td>is a rank 1 array containing the energy data </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">data_mean</td><td>is the </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">param_pres</td><td>Rank 2 arrays </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">param_pres</td><td>rank 2 array containing @param_cov rank 2 array containing the covariance matrix </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">param_data</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Dimension Names - named the same as the input variables</p>
<p>ID's</p>
<p>Create the file</p>
<p>Defining the Scalar Variables</p>
<p>Inputting in the Array variables and defining the dimensions</p>
<p>Rank 1 arrays first</p>
<p>Rank 2 arrays</p>
<p>Writing the array data to file</p>
<p>Scalar Values</p>
<p>Rank 1 arrays</p>
<p>Rank 2 arrays</p>
<p>Closing the file</p>

<p class="definition">Definition at line <a class="el" href="netcdf__file_8f90_source.html#l00224">224</a> of file <a class="el" href="netcdf__file_8f90_source.html">netcdf_file.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: dp=kind(1.0d0)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">! Declaring the input variables</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span> :: filename = <span class="stringliteral">&#39;restart.nc4&#39;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordtype">INTEGER</span> :: ierr, file_id, i</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keywordtype">    REAL</span>(dp) :: gp_n_data, gp_n_dof, n_cycles, no_samples, current_best_E</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keywordtype">    REAL</span>(dp) :: constant_mean_value, gamma, kernel_var, kernal_inv_length</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_gp_n_data, var_gp_n_dof, var_n_cycles, var_no_samples</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_current_best_E, var_constant_mean_value, var_gamma</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_kernel_var, var_kernal_inv_length</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: E_data</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">INTENT(IN)</span> :: data_mean</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(IN)</span> :: param_pres</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(IN)</span> :: param_cov</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">INTENT(IN)</span> :: param_data</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(1)</span> :: dim_e_data = (/<span class="stringliteral">&quot;E_Data&quot;</span>/)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(1)</span> :: dim_data_mean = (/<span class="stringliteral">&quot;data_mean&quot;</span>/)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(2)</span> :: dim_param_pres = (/<span class="stringliteral">&quot;param_pres&quot;</span>,<span class="stringliteral">&quot;param_pres&quot;</span>/)</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(2)</span> :: dim_param_cov = (/<span class="stringliteral">&quot;param_cov&quot;</span>,<span class="stringliteral">&quot;param_cov&quot;</span>/)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">CHARACTER(LEN=100)</span>, <span class="keywordtype">DIMENSION(2)</span> :: dim_param_data = (/<span class="stringliteral">&quot;param_data&quot;</span>,<span class="stringliteral">&quot;param_data&quot;</span>/)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">! Variable IDs</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_e_data, var_data_mean, var_param_pres</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">INTEGER</span> :: var_param_cov, var_param_data</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">! Dimension IDs for the arrays</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(1)</span> :: did_e_data, did_data_mean</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(2)</span> :: did_param_cov, did_param_data, did_param_pres</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">! Sizes for the arrays</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(1)</span> :: size_e_data, size_data_mean</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">DIMENSION(2)</span> :: size_param_cov, size_param_data, size_param_pres</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    ierr = nf90_create(filename, nf90_clobber, file_id)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">! Variable sizes</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    size_e_data = shape(e_data)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    size_data_mean = shape(data_mean)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    size_param_pres = shape(param_pres)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    size_param_cov = shape(param_cov)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    size_param_data = shape(param_data)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;gp_n_data&quot;</span>, nf90_double, var_gp_n_data)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;gp_n_dof&quot;</span>, nf90_double, var_gp_n_dof)</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;n_cycles&quot;</span>, nf90_double, var_n_cycles)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;no_samples&quot;</span>, nf90_double, var_no_samples)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;current_best_e&quot;</span>, nf90_double, var_current_best_e)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;constant_mean_value&quot;</span>, nf90_double, var_constant_mean_value)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;gamma&quot;</span>, nf90_double, var_gamma)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;kernel_var&quot;</span>, nf90_double, var_kernel_var)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;kernal_inv_length&quot;</span>, nf90_double, var_kernal_inv_length)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    ierr = nf90_def_dim(file_id, dim_e_data(1), size_e_data(1), did_e_data(1))</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;E_data&quot;</span>, nf90_double, did_e_data, var_e_data)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    ierr = nf90_def_dim(file_id, dim_data_mean(1), size_data_mean(1), did_data_mean(1))</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;data_mean&quot;</span>, nf90_double, did_data_mean, var_data_mean)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">DO</span> i = 1,2</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      ierr = nf90_def_var(file_id, dim_param_pres(i), size_param_pres(i), did_param_pres(i))</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;param_pres&quot;</span>, nf90_double, did_param_pres, var_param_pres)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">DO</span> i = 1,2</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      ierr = nf90_def_var(file_id, dim_param_cov(i), size_param_cov(i), did_param_cov(i))</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;param_cov&quot;</span>, nf90_double, did_param_cov, var_param_cov)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">DO</span> i = 1,2</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      ierr = nf90_def_var(file_id, dim_param_data(i), size_param_data(i), did_param_data(i))</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    ierr = nf90_def_var(file_id, <span class="stringliteral">&quot;param_data&quot;</span>, nf90_double, did_param_data, var_param_data)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">! Metadata</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    ierr = nf90_enddef(file_id)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    ierr = nf90_put_var(file_id, var_gp_n_data, gp_n_data)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    ierr = nf90_put_var(file_id, var_gp_n_dof, gp_n_dof)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    ierr = nf90_put_var(file_id, var_n_cycles, n_cycles)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    ierr = nf90_put_var(file_id, var_no_samples, no_samples)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    ierr = nf90_put_var(file_id, var_current_best_e, current_best_e)</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    ierr = nf90_put_var(file_id, var_constant_mean_value, constant_mean_value)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    ierr = nf90_put_var(file_id, var_gamma, gamma)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    ierr = nf90_put_var(file_id, var_kernel_var, kernel_var)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    ierr = nf90_put_var(file_id, var_kernal_inv_length, kernal_inv_length)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160; </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    ierr = nf90_put_var(file_id, var_e_data, e_data)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    ierr = nf90_put_var(file_id, var_data_mean, data_mean)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    ierr = nf90_put_var(file_id, var_param_pres, param_pres)</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    ierr = nf90_put_var(file_id, var_param_cov, param_cov)</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    ierr = nf90_put_var(file_id, var_param_data, param_data)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    ierr = nf90_close(file_id)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">IF</span> (ierr /= nf90_noerr) <span class="keyword">CALL </span>handle_err(ierr)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    print *, <span class="stringliteral">&quot;Success in writing file: &quot;</span>, filename</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="netcdf__file_8f90_source.html#l00436">handle_err()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewrite__file_a85af283f6b75ebd924045dbb95bf169a_cgraph.png" border="0" usemap="#namespacewrite__file_a85af283f6b75ebd924045dbb95bf169a_cgraph" alt=""/></div>
<map name="namespacewrite__file_a85af283f6b75ebd924045dbb95bf169a_cgraph" id="namespacewrite__file_a85af283f6b75ebd924045dbb95bf169a_cgraph">
<area shape="rect" title="Creates a NetCDF file which contains information needed for the restart of the Bi_Op_step function." alt="" coords="5,5,208,32"/>
<area shape="rect" href="namespacewrite__file.html#a7bee3284ae2e7b54b1a499095dfee1ee" title="Handles the NetCDF errors and print statements." alt="" coords="256,5,416,32"/>
</map>
</div>

</div>
</div>
<a id="a988eccddc1dfeda968686c7155ce133a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a988eccddc1dfeda968686c7155ce133a">&#9670;&nbsp;</a></span>xy_grid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine write_file::xy_grid </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>points</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>box_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes the xyz coordinates used in the calculation of either the wavefunction or electron density to a text file names xyz.txt. </p>
<p>This only produces a equally spaced square grid of points in the x-y plane, with the z coordinate being set to zero. These coordinates are used for the 2D contour plot in the resulting output plot. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">box_size</td><td>box_size is the user defined parameter which defines the size of the domain in each axis. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">points</td><td>points is the user defined </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="netcdf__file_8f90_source.html#l00185">185</a> of file <a class="el" href="netcdf__file_8f90_source.html">netcdf_file.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: dp=kind(1.0d0)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keywordtype">    REAL</span>(dp), <span class="keywordtype">INTENT(IN)</span> :: box_size</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">INTENT(IN)</span> :: points</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">! Loop variables</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">INTEGER</span> :: i,j</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">! Resulting position values in x-y axis</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keywordtype">    REAL</span>(dp) :: a, b <span class="comment">! a is x, b is y</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: file_no=3</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">! Opens an empty text file</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keyword">OPEN</span> (unit=file_no,file=<span class="stringliteral">&quot;xyz.txt&quot;</span>,action=<span class="stringliteral">&quot;write&quot;</span>)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">DO</span> i = -points, points</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">DO</span> j = -points, points</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="comment">! Scales the positions to be between -box_size and +box_size</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        a =  (real(i) / (abs(points) + abs(points)))*box_size</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        b =  (real(j) / (abs(points) + abs(points)))*box_size</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="comment">! Writes the coordinates to file, the z coordinate is set to zero as only using this for 2D contour plot which requires x and y coordinates to change.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keyword">write</span> (file_no,*) a,b,0</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keywordflow">      END DO</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordflow">    END DO</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">! Closes the file after writing</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keyword">CLOSE</span> (file_no)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    print*, <span class="stringliteral">&#39;Success in writing: xyz.txt&#39;</span></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="latin__driver_8f90_source.html#l00007">main_driver()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacewrite__file_a988eccddc1dfeda968686c7155ce133a_icgraph.png" border="0" usemap="#namespacewrite__file_a988eccddc1dfeda968686c7155ce133a_icgraph" alt=""/></div>
<map name="namespacewrite__file_a988eccddc1dfeda968686c7155ce133a_icgraph" id="namespacewrite__file_a988eccddc1dfeda968686c7155ce133a_icgraph">
<area shape="rect" title="Writes the xyz coordinates used in the calculation of either the wavefunction or electron density to ..." alt="" coords="153,5,292,32"/>
<area shape="rect" href="latin__driver_8f90.html#a9c41b02ba03edb8de4ce1751ea3cf05f" title="Main driver for simulation using the latin_hypercube search." alt="" coords="5,5,105,32"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacewrite__file.html">write_file</a></li>
    <li class="footer">Generated on Thu May 27 2021 03:14:32 for PX 915: Variational Quantum Monte Carlo - LATIN by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
